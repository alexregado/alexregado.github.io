var trackjs_version="1.2";if(typeof JSON_CAPTURLY!=="object"&&typeof window.JSON==="object"&&window.JSON.stringify&&window.JSON.parse){JSON_CAPTURLY=window.JSON}else{(function(){var a={};/*!JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org*/(function(){var c=typeof define==="function"&&define.amd;var e={"function":true,object:true};var h=e[typeof a]&&a&&!a.nodeType&&a;var j=e[typeof window]&&window||this,b=h&&e[typeof module]&&module&&!module.nodeType&&typeof global=="object"&&global;if(b&&(b.global===b||b.window===b||b.self===b)){j=b}function k(ac,W){ac||(ac=j.Object());W||(W=j.Object());var L=ac.Number||j.Number,S=ac.String||j.String,y=ac.Object||j.Object,T=ac.Date||j.Date,U=ac.SyntaxError||j.SyntaxError,ab=ac.TypeError||j.TypeError,K=ac.Math||j.Math,Z=ac.JSON||j.JSON;if(typeof Z=="object"&&Z){W.stringify=Z.stringify;W.parse=Z.parse}var o=y.prototype,v=o.toString,s,n,M;var C=new T(-3509827334573292);try{C=C.getUTCFullYear()==-109252&&C.getUTCMonth()===0&&C.getUTCDate()===1&&C.getUTCHours()==10&&C.getUTCMinutes()==37&&C.getUTCSeconds()==6&&C.getUTCMilliseconds()==708}catch(w){}function p(ad){if(p[ad]!==M){return p[ad]}var ae;if(ad=="bug-string-char-index"){ae="a"[0]!="a"}else{if(ad=="json"){ae=p("json-stringify")&&p("json-parse")}else{var al,ai='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(ad=="json-stringify"){var aj=W.stringify,ak=typeof aj=="function"&&C;if(ak){(al=function(){return 1}).toJSON=al;try{ak=aj(0)==="0"&&aj(new L())==="0"&&aj(new S())=='""'&&aj(v)===M&&aj(M)===M&&aj()===M&&aj(al)==="1"&&aj([al])=="[1]"&&aj([M])=="[null]"&&aj(null)=="null"&&aj([M,v,null])=="[null,null,null]"&&aj({a:[al,true,false,null,"\x00\b\n\f\r\t"]})==ai&&aj(null,al)==="1"&&aj([1,2],null,1)=="[\n 1,\n 2\n]"&&aj(new T(-8640000000000000))=='"-271821-04-20T00:00:00.000Z"'&&aj(new T(8640000000000000))=='"+275760-09-13T00:00:00.000Z"'&&aj(new T(-62198755200000))=='"-000001-01-01T00:00:00.000Z"'&&aj(new T(-1))=='"1969-12-31T23:59:59.999Z"'}catch(af){ak=false}}ae=ak}if(ad=="json-parse"){var ah=W.parse;if(typeof ah=="function"){try{if(ah("0")===0&&!ah(false)){al=ah(ai);var ag=al.a.length==5&&al.a[0]===1;if(ag){try{ag=!ah('"\t"')}catch(af){}if(ag){try{ag=ah("01")!==1}catch(af){}}if(ag){try{ag=ah("1.")!==1}catch(af){}}}}}catch(af){ag=false}}ae=ag}}}return p[ad]=!!ae}if(!p("json")){var V="[object Function]",R="[object Date]",O="[object Number]",P="[object String]",F="[object Array]",B="[object Boolean]";var G=p("bug-string-char-index");if(!C){var t=K.floor;var aa=[0,31,59,90,120,151,181,212,243,273,304,334];var E=function(ad,ae){return aa[ae]+365*(ad-1970)+t((ad-1969+(ae=+(ae>1)))/4)-t((ad-1901+ae)/100)+t((ad-1601+ae)/400)}}if(!(s=o.hasOwnProperty)){s=function(af){var ad={},ae;if((ad.__proto__=null,ad.__proto__={toString:1},ad).toString!=v){s=function(ai){var ah=this.__proto__,ag=ai in(this.__proto__=null,this);this.__proto__=ah;return ag}}else{ae=ad.constructor;s=function(ah){var ag=(this.constructor||ae).prototype;return ah in this&&!(ah in ag&&this[ah]===ag[ah])}}ad=null;return s.call(this,af)}}n=function(af,ai){var ag=0,ad,ae,ah;(ad=function(){this.valueOf=0}).prototype.valueOf=0;ae=new ad();for(ah in ae){if(s.call(ae,ah)){ag++}}ad=ae=null;if(!ag){ae=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];n=function(ak,ao){var an=v.call(ak)==V,am,al;var aj=!an&&typeof ak.constructor!="function"&&e[typeof ak.hasOwnProperty]&&ak.hasOwnProperty||s;for(am in ak){if(!(an&&am=="prototype")&&aj.call(ak,am)){ao(am)}}for(al=ae.length;am=ae[--al];aj.call(ak,am)&&ao(am)){}}}else{if(ag==2){n=function(ak,an){var aj={},am=v.call(ak)==V,al;for(al in ak){if(!(am&&al=="prototype")&&!s.call(aj,al)&&(aj[al]=1)&&s.call(ak,al)){an(al)}}}}else{n=function(ak,an){var am=v.call(ak)==V,al,aj;for(al in ak){if(!(am&&al=="prototype")&&s.call(ak,al)&&!(aj=al==="constructor")){an(al)}}if(aj||s.call(ak,(al="constructor"))){an(al)}}}}return n(af,ai)};if(!p("json-stringify")){var r={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"};var J="000000";var u=function(ad,ae){return(J+(ae||0)).slice(-ad)};var A="\\u00";var D=function(aj){var ae='"',ah=0,ai=aj.length,ad=!G||ai>10;var ag=ad&&(G?aj.split(""):aj);for(;ah<ai;ah++){var af=aj.charCodeAt(ah);switch(af){case 8:case 9:case 10:case 12:case 13:case 34:case 92:ae+=r[af];break;default:if(af<32){ae+=A+u(2,af.toString(16));break}ae+=ad?ag[ah]:aj.charAt(ah)}}return ae+'"'};var q=function(aj,aB,ah,am,ay,ad,ak){var au,af,aq,aA,az,al,ax,av,ar,ao,at,ae,ai,ag,aw,ap;try{au=aB[aj]}catch(an){}if(typeof au=="object"&&au){af=v.call(au);if(af==R&&!s.call(au,"toJSON")){if(au>-1/0&&au<1/0){if(E){az=t(au/86400000);for(aq=t(az/365.2425)+1970-1;E(aq+1,0)<=az;aq++){}for(aA=t((az-E(aq,0))/30.42);E(aq,aA+1)<=az;aA++){}az=1+az-E(aq,aA);al=(au%86400000+86400000)%86400000;ax=t(al/3600000)%24;av=t(al/60000)%60;ar=t(al/1000)%60;ao=al%1000}else{aq=au.getUTCFullYear();aA=au.getUTCMonth();az=au.getUTCDate();ax=au.getUTCHours();av=au.getUTCMinutes();ar=au.getUTCSeconds();ao=au.getUTCMilliseconds()}au=(aq<=0||aq>=10000?(aq<0?"-":"+")+u(6,aq<0?-aq:aq):u(4,aq))+"-"+u(2,aA+1)+"-"+u(2,az)+"T"+u(2,ax)+":"+u(2,av)+":"+u(2,ar)+"."+u(3,ao)+"Z"}else{au=null}}else{if(typeof au.toJSON=="function"&&((af!=O&&af!=P&&af!=F)||s.call(au,"toJSON"))){au=au.toJSON(aj)}}}if(ah){au=ah.call(aB,aj,au)}if(au===null){return"null"}af=v.call(au);if(af==B){return""+au}else{if(af==O){return au>-1/0&&au<1/0?""+au:"null"}else{if(af==P){return D(""+au)}}}if(typeof au=="object"){for(ag=ak.length;ag--;){if(ak[ag]===au){throw ab()}}ak.push(au);at=[];aw=ad;ad+=ay;if(af==F){for(ai=0,ag=au.length;ai<ag;ai++){ae=q(ai,au,ah,am,ay,ad,ak);at.push(ae===M?"null":ae)}ap=at.length?(ay?"[\n"+ad+at.join(",\n"+ad)+"\n"+aw+"]":("["+at.join(",")+"]")):"[]"}else{n(am||au,function(aD){var aC=q(aD,au,ah,am,ay,ad,ak);if(aC!==M){at.push(D(aD)+":"+(ay?" ":"")+aC)}});ap=at.length?(ay?"{\n"+ad+at.join(",\n"+ad)+"\n"+aw+"}":("{"+at.join(",")+"}")):"{}"}ak.pop();return ap}};W.stringify=function(ad,af,ag){var ae,am,ak,aj;if(e[typeof af]&&af){if((aj=v.call(af))==V){am=af}else{if(aj==F){ak={};for(var ai=0,ah=af.length,al;ai<ah;al=af[ai++],((aj=v.call(al)),aj==P||aj==O)&&(ak[al]=1)){}}}}if(ag){if((aj=v.call(ag))==O){if((ag-=ag%1)>0){for(ae="",ag>10&&(ag=10);ae.length<ag;ae+=" "){}}}else{if(aj==P){ae=ag.length<=10?ag:ag.slice(0,10)}}}return q("",(al={},al[""]=ad,al),am,ak,ae,"",[])}}if(!p("json-parse")){var N=S.fromCharCode;var m={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"};var H,Y;var I=function(){H=Y=null;throw U()};var z=function(){var ai=Y,ag=ai.length,ah,af,ad,aj,ae;while(H<ag){ae=ai.charCodeAt(H);switch(ae){case 9:case 10:case 13:case 32:H++;break;case 123:case 125:case 91:case 93:case 58:case 44:ah=G?ai.charAt(H):ai[H];H++;return ah;case 34:for(ah="@",H++;H<ag;){ae=ai.charCodeAt(H);if(ae<32){I()}else{if(ae==92){ae=ai.charCodeAt(++H);switch(ae){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:ah+=m[ae];H++;break;case 117:af=++H;for(ad=H+4;H<ad;H++){ae=ai.charCodeAt(H);if(!(ae>=48&&ae<=57||ae>=97&&ae<=102||ae>=65&&ae<=70)){I()}}ah+=N("0x"+ai.slice(af,H));break;default:I()}}else{if(ae==34){break}ae=ai.charCodeAt(H);af=H;while(ae>=32&&ae!=92&&ae!=34){ae=ai.charCodeAt(++H)}ah+=ai.slice(af,H)}}}if(ai.charCodeAt(H)==34){H++;return ah}I();default:af=H;if(ae==45){aj=true;ae=ai.charCodeAt(++H)}if(ae>=48&&ae<=57){if(ae==48&&((ae=ai.charCodeAt(H+1)),ae>=48&&ae<=57)){I()}aj=false;for(;H<ag&&((ae=ai.charCodeAt(H)),ae>=48&&ae<=57);H++){}if(ai.charCodeAt(H)==46){ad=++H;for(;ad<ag&&((ae=ai.charCodeAt(ad)),ae>=48&&ae<=57);ad++){}if(ad==H){I()}H=ad}ae=ai.charCodeAt(H);if(ae==101||ae==69){ae=ai.charCodeAt(++H);if(ae==43||ae==45){H++}for(ad=H;ad<ag&&((ae=ai.charCodeAt(ad)),ae>=48&&ae<=57);ad++){}if(ad==H){I()}H=ad}return+ai.slice(af,H)}if(aj){I()}if(ai.slice(H,H+4)=="true"){H+=4;return true}else{if(ai.slice(H,H+5)=="false"){H+=5;return false}else{if(ai.slice(H,H+4)=="null"){H+=4;return null}}}I()}}return"$"};var X=function(ae){var ad,af;if(ae=="$"){I()}if(typeof ae=="string"){if((G?ae.charAt(0):ae[0])=="@"){return ae.slice(1)}if(ae=="["){ad=[];for(;;af||(af=true)){ae=z();if(ae=="]"){break}if(af){if(ae==","){ae=z();if(ae=="]"){I()}}else{I()}}if(ae==","){I()}ad.push(X(ae))}return ad}else{if(ae=="{"){ad={};for(;;af||(af=true)){ae=z();if(ae=="}"){break}if(af){if(ae==","){ae=z();if(ae=="}"){I()}}else{I()}}if(ae==","||typeof ae!="string"||(G?ae.charAt(0):ae[0])!="@"||z()!=":"){I()}ad[ae.slice(1)]=X(z())}return ad}}I()}return ae};var Q=function(af,ae,ag){var ad=x(af,ae,ag);if(ad===M){delete af[ae]}else{af[ae]=ad}};var x=function(ag,af,ah){var ae=ag[af],ad;if(typeof ae=="object"&&ae){if(v.call(ae)==F){for(ad=ae.length;ad--;){Q(ae,ad,ah)}}else{n(ae,function(ai){Q(ae,ai,ah)})}}return ah.call(ag,af,ae)};W.parse=function(af,ag){var ad,ae;H=0;Y=""+af;ad=X(z());if(z()!="$"){I()}H=Y=null;return ag&&v.call(ag)==V?x((ae={},ae[""]=ad,ae),"",ag):ad}}}W.runInContext=k;return W}if(h&&!c){k(j,h)}else{var f=j.JSON,l=j.JSON3,d=false;var g=k(j,(j.JSON3={noConflict:function(){if(!d){d=true;j.JSON=f;j.JSON3=l;f=l=null}return g}}));j.JSON={parse:g.parse,stringify:g.stringify}}if(c){define(function(){return g})}}).call(this);JSON_CAPTURLY=a})()}if(typeof _paq!=="object"){_paq=[]}if(typeof window.Capturly!=="object"){window.Capturly=(function(){var expireDateTime,plugins={},eventHandlers={},documentAlias=document,navigatorAlias=navigator,screenAlias=screen,windowAlias=window,performanceAlias=windowAlias.performance||windowAlias.mozPerformance||windowAlias.msPerformance||windowAlias.webkitPerformance,encodeWrapper=windowAlias.encodeURIComponent,decodeWrapper=windowAlias.decodeURIComponent,urldecode=unescape,asyncTrackers=[],iterator,Capturly,missedPluginTrackerCalls=[];function safeDecodeWrapper(url){try{return decodeWrapper(url)}catch(e){return unescape(url)}}function isDefined(property){var propertyType=typeof property;return propertyType!=="undefined"}function isFunction(property){return typeof property==="function"}function isObject(property){return typeof property==="object"}function isString(property){return typeof property==="string"||property instanceof String}function isObjectEmpty(property){if(!property){return true}var i;var isEmpty=true;for(i in property){if(Object.prototype.hasOwnProperty.call(property,i)){isEmpty=false}}return isEmpty}function logConsoleError(message){var consoleType=typeof console;if(consoleType!=="undefined"&&console&&console.error){console.error(message)}}function apply(){var i,j,f,parameterArray,trackerCall;for(i=0;i<arguments.length;i+=1){trackerCall=null;if(arguments[i]&&arguments[i].slice){trackerCall=arguments[i].slice()}parameterArray=arguments[i];f=parameterArray.shift();var fParts,context;var isStaticPluginCall=isString(f)&&f.indexOf("::")>0;if(isStaticPluginCall){fParts=f.split("::");context=fParts[0];f=fParts[1];if("object"===typeof Capturly[context]&&"function"===typeof Capturly[context][f]){Capturly[context][f].apply(Capturly[context],parameterArray)}else{if(trackerCall){missedPluginTrackerCalls.push(trackerCall)}}}else{for(j=0;j<asyncTrackers.length;j++){if(isString(f)){context=asyncTrackers[j];var isPluginTrackerCall=f.indexOf(".")>0;if(isPluginTrackerCall){fParts=f.split(".");if(context&&"object"===typeof context[fParts[0]]){context=context[fParts[0]];f=fParts[1]}else{if(trackerCall){missedPluginTrackerCalls.push(trackerCall);break}}}if(context[f]){context[f].apply(context,parameterArray)}else{var message="The method '"+f+'\' was not found in "_paq" variable.';logConsoleError(message);if(!isPluginTrackerCall){throw new TypeError(message)}}if(f==="addTracker"){break}if(f==="setTrackerUrl"||f==="setSiteId"){break}}else{f.apply(asyncTrackers[j],parameterArray)}}}}}function addEventListener(element,eventType,eventHandler,useCapture){if(element.addEventListener){element.addEventListener(eventType,eventHandler,useCapture);return true}if(element.attachEvent){return element.attachEvent("on"+eventType,eventHandler)}element["on"+eventType]=eventHandler}function trackCallbackOnLoad(callback){if(documentAlias.readyState==="complete"){callback()}else{if(windowAlias.addEventListener){windowAlias.addEventListener("load",callback)}else{if(windowAlias.attachEvent){windowAlias.attachEvent("onload",callback)}}}}function trackCallbackOnReady(callback){var loaded=false;if(documentAlias.attachEvent){loaded=documentAlias.readyState==="complete"}else{loaded=documentAlias.readyState!=="loading"}if(loaded){callback();return}var _timer;if(documentAlias.addEventListener){addEventListener(documentAlias,"DOMContentLoaded",function ready(){documentAlias.removeEventListener("DOMContentLoaded",ready,false);if(!loaded){loaded=true;callback()}})}else{if(documentAlias.attachEvent){documentAlias.attachEvent("onreadystatechange",function ready(){if(documentAlias.readyState==="complete"){documentAlias.detachEvent("onreadystatechange",ready);if(!loaded){loaded=true;callback()}}});if(documentAlias.documentElement.doScroll&&windowAlias===windowAlias.top){(function ready(){if(!loaded){try{documentAlias.documentElement.doScroll("left")}catch(error){setTimeout(ready,0);return}loaded=true;callback()}}())}}}addEventListener(windowAlias,"load",function(){if(!loaded){loaded=true;callback()}},false)}function executePluginMethod(methodName,params,callback){if(!methodName){return""}var result="",i,pluginMethod,value,isFunction;for(i in plugins){if(Object.prototype.hasOwnProperty.call(plugins,i)){isFunction=plugins[i]&&"function"===typeof plugins[i][methodName];if(isFunction){pluginMethod=plugins[i][methodName];value=pluginMethod(params||{},callback);if(value){result+=value}}}}return result}function beforeUnloadHandler(){var now;executePluginMethod("unload");if(expireDateTime){do{now=new Date()}while(now.getTimeAlias()<expireDateTime)}}function loadScript(src,onLoad){var script=documentAlias.createElement("script");script.type="text/javascript";script.src=src;if(script.readyState){script.onreadystatechange=function(){var state=this.readyState;if(state==="loaded"||state==="complete"){script.onreadystatechange=null;onLoad()}}}else{script.onload=onLoad}documentAlias.getElementsByTagName("head")[0].appendChild(script)}function getReferrer(){var referrer="";try{referrer=windowAlias.top.document.referrer}catch(e){if(windowAlias.parent){try{referrer=windowAlias.parent.document.referrer}catch(e2){referrer=""}}}if(referrer===""){referrer=documentAlias.referrer}return referrer}function getProtocolScheme(url){var e=new RegExp("^([a-z]+):"),matches=e.exec(url);return matches?matches[1]:null}function getHostName(url){var e=new RegExp("^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)"),matches=e.exec(url);return matches?matches[1]:url}function stringStartsWith(str,prefix){str=String(str);return str.lastIndexOf(prefix,0)===0}function stringEndsWith(str,suffix){str=String(str);return str.indexOf(suffix,str.length-suffix.length)!==-1}function stringContains(str,needle){str=String(str);return str.indexOf(needle)!==-1}function removeCharactersFromEndOfString(str,numCharactersToRemove){str=String(str);return str.substr(0,str.length-numCharactersToRemove)}function addUrlParameter(url,name,value){url=String(url);if(!value){value=""}var hashPos=url.indexOf("#");var urlLength=url.length;if(hashPos===-1){hashPos=urlLength}var baseUrl=url.substr(0,hashPos);var urlHash=url.substr(hashPos,urlLength-hashPos);if(baseUrl.indexOf("?")===-1){baseUrl+="?"}else{if(!stringEndsWith(baseUrl,"?")){baseUrl+="&"}}return baseUrl+encodeWrapper(name)+"="+encodeWrapper(value)+urlHash}function removeUrlParameter(url,name){url=String(url);if(url.indexOf("?"+name+"=")===-1&&url.indexOf("&"+name+"=")===-1){return url}var searchPos=url.indexOf("?");if(searchPos===-1){return url}var queryString=url.substr(searchPos+1);var baseUrl=url.substr(0,searchPos);if(queryString){var urlHash="";var hashPos=queryString.indexOf("#");if(hashPos!==-1){urlHash=queryString.substr(hashPos+1);queryString=queryString.substr(0,hashPos)}var param;var paramsArr=queryString.split("&");var i=paramsArr.length-1;for(i;i>=0;i--){param=paramsArr[i].split("=")[0];if(param===name){paramsArr.splice(i,1)}}var newQueryString=paramsArr.join("&");if(newQueryString){baseUrl=baseUrl+"?"+newQueryString}if(urlHash){baseUrl+="#"+urlHash}}return baseUrl}function getUrlParameter(url,name){var regexSearch="[\\?&#]"+name+"=([^&#]*)";var regex=new RegExp(regexSearch);var results=regex.exec(url);return results?decodeWrapper(results[1]):""}function utf8_encode(argString){return unescape(encodeWrapper(argString))}function sha1(str){var rotate_left=function(n,s){return(n<<s)|(n>>>(32-s))},cvt_hex=function(val){var strout="",i,v;for(i=7;i>=0;i--){v=(val>>>(i*4))&15;strout+=v.toString(16)}return strout},blockstart,i,j,W=[],H0=1732584193,H1=4023233417,H2=2562383102,H3=271733878,H4=3285377520,A,B,C,D,E,temp,str_len,word_array=[];str=utf8_encode(str);str_len=str.length;for(i=0;i<str_len-3;i+=4){j=str.charCodeAt(i)<<24|str.charCodeAt(i+1)<<16|str.charCodeAt(i+2)<<8|str.charCodeAt(i+3);word_array.push(j)}switch(str_len&3){case 0:i=2147483648;break;case 1:i=str.charCodeAt(str_len-1)<<24|8388608;break;case 2:i=str.charCodeAt(str_len-2)<<24|str.charCodeAt(str_len-1)<<16|32768;break;case 3:i=str.charCodeAt(str_len-3)<<24|str.charCodeAt(str_len-2)<<16|str.charCodeAt(str_len-1)<<8|128;break}word_array.push(i);while((word_array.length&15)!==14){word_array.push(0)}word_array.push(str_len>>>29);word_array.push((str_len<<3)&4294967295);for(blockstart=0;blockstart<word_array.length;blockstart+=16){for(i=0;i<16;i++){W[i]=word_array[blockstart+i]}for(i=16;i<=79;i++){W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1)}A=H0;B=H1;C=H2;D=H3;E=H4;for(i=0;i<=19;i++){temp=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+1518500249)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=20;i<=39;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+1859775393)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=40;i<=59;i++){temp=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+2400959708)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=60;i<=79;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+3395469782)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}H0=(H0+A)&4294967295;H1=(H1+B)&4294967295;H2=(H2+C)&4294967295;H3=(H3+D)&4294967295;H4=(H4+E)&4294967295}temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4);return temp.toLowerCase()}function urlFixup(hostName,href,referrer){if(!hostName){hostName=""}if(!href){href=""}if(hostName==="translate.googleusercontent.com"){if(referrer===""){referrer=href}href=getUrlParameter(href,"u");hostName=getHostName(href)}else{if(hostName==="cc.bingj.com"||hostName==="webcache.googleusercontent.com"||hostName.slice(0,5)==="74.6."){href=documentAlias.links[0].href;hostName=getHostName(href)}}return[hostName,href,referrer]}function domainFixup(domain){var dl=domain.length;if(domain.charAt(--dl)==="."){domain=domain.slice(0,dl)}if(domain.slice(0,2)==="*."){domain=domain.slice(1)}if(domain.indexOf("/")!==-1){domain=domain.substr(0,domain.indexOf("/"))}return domain}function titleFixup(title){title=title&&title.text?title.text:title;if(!isString(title)){var tmp=documentAlias.getElementsByTagName("title");if(tmp&&isDefined(tmp[0])){title=tmp[0].text}}return title}function getChildrenFromNode(node){if(!node){return[]}if(!isDefined(node.children)&&isDefined(node.childNodes)){return node.children}if(isDefined(node.children)){return node.children}return[]}function containsNodeElement(node,containedNode){if(!node||!containedNode){return false}if(node.contains){return node.contains(containedNode)}if(node===containedNode){return true}if(node.compareDocumentPosition){return!!(node.compareDocumentPosition(containedNode)&16)}return false}function indexOfArray(theArray,searchElement){if(theArray&&theArray.indexOf){return theArray.indexOf(searchElement)}if(!isDefined(theArray)||theArray===null){return-1}if(!theArray.length){return-1}var len=theArray.length;if(len===0){return-1}var k=0;while(k<len){if(theArray[k]===searchElement){return k}k++}return-1}function isVisible(node){if(!node){return false}function _getStyle(el,property){if(windowAlias.getComputedStyle){return documentAlias.defaultView.getComputedStyle(el,null)[property]}if(el.currentStyle){return el.currentStyle[property]}}function _elementInDocument(element){element=element.parentNode;while(element){if(element===documentAlias){return true}element=element.parentNode}return false}function _isVisible(el,t,r,b,l,w,h){var p=el.parentNode,VISIBLE_PADDING=1;if(!_elementInDocument(el)){return false}if(9===p.nodeType){return true}if("0"===_getStyle(el,"opacity")||"none"===_getStyle(el,"display")||"hidden"===_getStyle(el,"visibility")){return false}if(!isDefined(t)||!isDefined(r)||!isDefined(b)||!isDefined(l)||!isDefined(w)||!isDefined(h)){t=el.offsetTop;l=el.offsetLeft;b=t+el.offsetHeight;r=l+el.offsetWidth;w=el.offsetWidth;h=el.offsetHeight}if(node===el&&(0===h||0===w)&&"hidden"===_getStyle(el,"overflow")){return false}if(p){if(("hidden"===_getStyle(p,"overflow")||"scroll"===_getStyle(p,"overflow"))){if(l+VISIBLE_PADDING>p.offsetWidth+p.scrollLeft||l+w-VISIBLE_PADDING<p.scrollLeft||t+VISIBLE_PADDING>p.offsetHeight+p.scrollTop||t+h-VISIBLE_PADDING<p.scrollTop){return false}}if(el.offsetParent===p){l+=p.offsetLeft;t+=p.offsetTop}return _isVisible(p,t,r,b,l,w,h)}return true}return _isVisible(node)}var query={htmlCollectionToArray:function(foundNodes){var nodes=[],index;if(!foundNodes||!foundNodes.length){return nodes}for(index=0;index<foundNodes.length;index++){nodes.push(foundNodes[index])}return nodes},find:function(selector){if(!document.querySelectorAll||!selector){return[]}var foundNodes=document.querySelectorAll(selector);return this.htmlCollectionToArray(foundNodes)},findMultiple:function(selectors){if(!selectors||!selectors.length){return[]}var index,foundNodes;var nodes=[];for(index=0;index<selectors.length;index++){foundNodes=this.find(selectors[index]);nodes=nodes.concat(foundNodes)}nodes=this.makeNodesUnique(nodes);return nodes},findNodesByTagName:function(node,tagName){if(!node||!tagName||!node.getElementsByTagName){return[]}var foundNodes=node.getElementsByTagName(tagName);return this.htmlCollectionToArray(foundNodes)},makeNodesUnique:function(nodes){var copy=[].concat(nodes);nodes.sort(function(n1,n2){if(n1===n2){return 0}var index1=indexOfArray(copy,n1);var index2=indexOfArray(copy,n2);if(index1===index2){return 0}return index1>index2?-1:1});if(nodes.length<=1){return nodes}var index=0;var numDuplicates=0;var duplicates=[];var node;node=nodes[index++];while(node){if(node===nodes[index]){numDuplicates=duplicates.push(index)}node=nodes[index++]||null}while(numDuplicates--){nodes.splice(duplicates[numDuplicates],1)}return nodes},getAttributeValueFromNode:function(node,attributeName){if(!this.hasNodeAttribute(node,attributeName)){return}if(node&&node.getAttribute){return node.getAttribute(attributeName)}if(!node||!node.attributes){return}var typeOfAttr=(typeof node.attributes[attributeName]);if("undefined"===typeOfAttr){return}if(node.attributes[attributeName].value){return node.attributes[attributeName].value}if(node.attributes[attributeName].nodeValue){return node.attributes[attributeName].nodeValue}var index;var attrs=node.attributes;if(!attrs){return}for(index=0;index<attrs.length;index++){if(attrs[index].nodeName===attributeName){return attrs[index].nodeValue}}return null},hasNodeAttributeWithValue:function(node,attributeName){var value=this.getAttributeValueFromNode(node,attributeName);return!!value},hasNodeAttribute:function(node,attributeName){if(node&&node.hasAttribute){return node.hasAttribute(attributeName)}if(node&&node.attributes){var typeOfAttr=(typeof node.attributes[attributeName]);return"undefined"!==typeOfAttr}return false},hasNodeCssClass:function(node,klassName){if(node&&klassName&&node.className){var classes=typeof node.className==="string"?node.className.split(" "):[];if(-1!==indexOfArray(classes,klassName)){return true}}return false},findNodesHavingAttribute:function(nodeToSearch,attributeName,nodes){if(!nodes){nodes=[]}if(!nodeToSearch||!attributeName){return nodes}var children=getChildrenFromNode(nodeToSearch);if(!children||!children.length){return nodes}var index,child;for(index=0;index<children.length;index++){child=children[index];if(this.hasNodeAttribute(child,attributeName)){nodes.push(child)}nodes=this.findNodesHavingAttribute(child,attributeName,nodes)}return nodes},findFirstNodeHavingAttribute:function(node,attributeName){if(!node||!attributeName){return}if(this.hasNodeAttribute(node,attributeName)){return node}var nodes=this.findNodesHavingAttribute(node,attributeName);if(nodes&&nodes.length){return nodes[0]}},findFirstNodeHavingAttributeWithValue:function(node,attributeName){if(!node||!attributeName){return}if(this.hasNodeAttributeWithValue(node,attributeName)){return node}var nodes=this.findNodesHavingAttribute(node,attributeName);if(!nodes||!nodes.length){return}var index;for(index=0;index<nodes.length;index++){if(this.getAttributeValueFromNode(nodes[index],attributeName)){return nodes[index]}}},findNodesHavingCssClass:function(nodeToSearch,className,nodes){if(!nodes){nodes=[]}if(!nodeToSearch||!className){return nodes}if(nodeToSearch.getElementsByClassName){var foundNodes=nodeToSearch.getElementsByClassName(className);return this.htmlCollectionToArray(foundNodes)}var children=getChildrenFromNode(nodeToSearch);if(!children||!children.length){return[]}var index,child;for(index=0;index<children.length;index++){child=children[index];if(this.hasNodeCssClass(child,className)){nodes.push(child)}nodes=this.findNodesHavingCssClass(child,className,nodes)}return nodes},findFirstNodeHavingClass:function(node,className){if(!node||!className){return}if(this.hasNodeCssClass(node,className)){return node}var nodes=this.findNodesHavingCssClass(node,className);if(nodes&&nodes.length){return nodes[0]}},isLinkElement:function(node){if(!node){return false}var elementName=String(node.nodeName).toLowerCase();var linkElementNames=["a","area"];var pos=indexOfArray(linkElementNames,elementName);return pos!==-1},setAnyAttribute:function(node,attrName,attrValue){if(!node||!attrName){return}if(node.setAttribute){node.setAttribute(attrName,attrValue)}else{node[attrName]=attrValue}}};var content={CONTENT_ATTR:"data-track-content",CONTENT_CLASS:"capturlyTrackContent",CONTENT_NAME_ATTR:"data-content-name",CONTENT_PIECE_ATTR:"data-content-piece",CONTENT_PIECE_CLASS:"capturlyContentPiece",CONTENT_TARGET_ATTR:"data-content-target",CONTENT_TARGET_CLASS:"capturlyContentTarget",CONTENT_IGNOREINTERACTION_ATTR:"data-content-ignoreinteraction",CONTENT_IGNOREINTERACTION_CLASS:"capturlyContentIgnoreInteraction",location:undefined,findContentNodes:function(){var cssSelector="."+this.CONTENT_CLASS;var attrSelector="["+this.CONTENT_ATTR+"]";var contentNodes=query.findMultiple([cssSelector,attrSelector]);return contentNodes},findContentNodesWithinNode:function(node){if(!node){return[]}var nodes1=query.findNodesHavingCssClass(node,this.CONTENT_CLASS);var nodes2=query.findNodesHavingAttribute(node,this.CONTENT_ATTR);if(nodes2&&nodes2.length){var index;for(index=0;index<nodes2.length;index++){nodes1.push(nodes2[index])}}if(query.hasNodeAttribute(node,this.CONTENT_ATTR)){nodes1.push(node)}else{if(query.hasNodeCssClass(node,this.CONTENT_CLASS)){nodes1.push(node)}}nodes1=query.makeNodesUnique(nodes1);return nodes1},findParentContentNode:function(anyNode){if(!anyNode){return}var node=anyNode;var counter=0;while(node&&node!==documentAlias&&node.parentNode){if(query.hasNodeAttribute(node,this.CONTENT_ATTR)){return node}if(query.hasNodeCssClass(node,this.CONTENT_CLASS)){return node}node=node.parentNode;if(counter>1000){break}counter++}},findPieceNode:function(node){var contentPiece;contentPiece=query.findFirstNodeHavingAttribute(node,this.CONTENT_PIECE_ATTR);if(!contentPiece){contentPiece=query.findFirstNodeHavingClass(node,this.CONTENT_PIECE_CLASS)}if(contentPiece){return contentPiece}return node},findTargetNodeNoDefault:function(node){if(!node){return}var target=query.findFirstNodeHavingAttributeWithValue(node,this.CONTENT_TARGET_ATTR);if(target){return target}target=query.findFirstNodeHavingAttribute(node,this.CONTENT_TARGET_ATTR);if(target){return target}target=query.findFirstNodeHavingClass(node,this.CONTENT_TARGET_CLASS);if(target){return target}},findTargetNode:function(node){var target=this.findTargetNodeNoDefault(node);if(target){return target}return node},findContentName:function(node){if(!node){return}var nameNode=query.findFirstNodeHavingAttributeWithValue(node,this.CONTENT_NAME_ATTR);if(nameNode){return query.getAttributeValueFromNode(nameNode,this.CONTENT_NAME_ATTR)}var contentPiece=this.findContentPiece(node);if(contentPiece){return this.removeDomainIfIsInLink(contentPiece)}if(query.hasNodeAttributeWithValue(node,"title")){return query.getAttributeValueFromNode(node,"title")}var clickUrlNode=this.findPieceNode(node);if(query.hasNodeAttributeWithValue(clickUrlNode,"title")){return query.getAttributeValueFromNode(clickUrlNode,"title")}var targetNode=this.findTargetNode(node);if(query.hasNodeAttributeWithValue(targetNode,"title")){return query.getAttributeValueFromNode(targetNode,"title")}},findContentPiece:function(node){if(!node){return}var nameNode=query.findFirstNodeHavingAttributeWithValue(node,this.CONTENT_PIECE_ATTR);if(nameNode){return query.getAttributeValueFromNode(nameNode,this.CONTENT_PIECE_ATTR)}var contentNode=this.findPieceNode(node);var media=this.findMediaUrlInNode(contentNode);if(media){return this.toAbsoluteUrl(media)}},findContentTarget:function(node){if(!node){return}var targetNode=this.findTargetNode(node);if(query.hasNodeAttributeWithValue(targetNode,this.CONTENT_TARGET_ATTR)){return query.getAttributeValueFromNode(targetNode,this.CONTENT_TARGET_ATTR)}var href;if(query.hasNodeAttributeWithValue(targetNode,"href")){href=query.getAttributeValueFromNode(targetNode,"href");return this.toAbsoluteUrl(href)}var contentNode=this.findPieceNode(node);if(query.hasNodeAttributeWithValue(contentNode,"href")){href=query.getAttributeValueFromNode(contentNode,"href");return this.toAbsoluteUrl(href)}},isSameDomain:function(url){if(!url||!url.indexOf){return false}if(0===url.indexOf(this.getLocation().origin)){return true}var posHost=url.indexOf(this.getLocation().host);if(8>=posHost&&0<=posHost){return true}return false},removeDomainIfIsInLink:function(text){var regexContainsProtocol="^https?://[^/]+";var regexReplaceDomain="^.*//[^/]+";if(text&&text.search&&-1!==text.search(new RegExp(regexContainsProtocol))&&this.isSameDomain(text)){text=text.replace(new RegExp(regexReplaceDomain),"");if(!text){text="/"}}return text},findMediaUrlInNode:function(node){if(!node){return}var mediaElements=["img","embed","video","audio"];var elementName=node.nodeName.toLowerCase();if(-1!==indexOfArray(mediaElements,elementName)&&query.findFirstNodeHavingAttributeWithValue(node,"src")){var sourceNode=query.findFirstNodeHavingAttributeWithValue(node,"src");return query.getAttributeValueFromNode(sourceNode,"src")}if(elementName==="object"&&query.hasNodeAttributeWithValue(node,"data")){return query.getAttributeValueFromNode(node,"data")}if(elementName==="object"){var params=query.findNodesByTagName(node,"param");if(params&&params.length){var index;for(index=0;index<params.length;index++){if("movie"===query.getAttributeValueFromNode(params[index],"name")&&query.hasNodeAttributeWithValue(params[index],"value")){return query.getAttributeValueFromNode(params[index],"value")}}}var embed=query.findNodesByTagName(node,"embed");if(embed&&embed.length){return this.findMediaUrlInNode(embed[0])}}},trim:function(text){if(text&&String(text)===text){return text.replace(/^\s+|\s+$/g,"")}return text},isOrWasNodeInViewport:function(node){if(!node||!node.getBoundingClientRect||node.nodeType!==1){return true}var rect=node.getBoundingClientRect();var html=documentAlias.documentElement||{};var wasVisible=rect.top<0;if(wasVisible&&node.offsetTop){wasVisible=(node.offsetTop+rect.height)>0}var docWidth=html.clientWidth;if(windowAlias.innerWidth&&docWidth>windowAlias.innerWidth){docWidth=windowAlias.innerWidth}var docHeight=html.clientHeight;if(windowAlias.innerHeight&&docHeight>windowAlias.innerHeight){docHeight=windowAlias.innerHeight}return((rect.bottom>0||wasVisible)&&rect.right>0&&rect.left<docWidth&&((rect.top<docHeight)||wasVisible))},isNodeVisible:function(node){var isItVisible=isVisible(node);var isInViewport=this.isOrWasNodeInViewport(node);return isItVisible&&isInViewport},buildInteractionRequestParams:function(interaction,name,piece,target){var params="";if(interaction){params+="c_i="+encodeWrapper(interaction)}if(name){if(params){params+="&"}params+="c_n="+encodeWrapper(name)}if(piece){if(params){params+="&"}params+="c_p="+encodeWrapper(piece)}if(target){if(params){params+="&"}params+="c_t="+encodeWrapper(target)}return params},buildImpressionRequestParams:function(name,piece,target){var params="c_n="+encodeWrapper(name)+"&c_p="+encodeWrapper(piece);if(target){params+="&c_t="+encodeWrapper(target)}return params},buildContentBlock:function(node){if(!node){return}var name=this.findContentName(node);var piece=this.findContentPiece(node);var target=this.findContentTarget(node);name=this.trim(name);piece=this.trim(piece);target=this.trim(target);return{name:name||"Unknown",piece:piece||"Unknown",target:target||""}},collectContent:function(contentNodes){if(!contentNodes||!contentNodes.length){return[]}var contents=[];var index,contentBlock;for(index=0;index<contentNodes.length;index++){contentBlock=this.buildContentBlock(contentNodes[index]);if(isDefined(contentBlock)){contents.push(contentBlock)}}return contents},setLocation:function(location){this.location=location},getLocation:function(){var locationAlias=this.location||windowAlias.location;if(!locationAlias.origin){locationAlias.origin=locationAlias.protocol+"//"+locationAlias.hostname+(locationAlias.port?":"+locationAlias.port:"")}return locationAlias},toAbsoluteUrl:function(url){if((!url||String(url)!==url)&&url!==""){return url}if(""===url){return this.getLocation().href}if(url.search(/^\/\//)!==-1){return this.getLocation().protocol+url}if(url.search(/:\/\//)!==-1){return url}if(0===url.indexOf("#")){return this.getLocation().origin+this.getLocation().pathname+url}if(0===url.indexOf("?")){return this.getLocation().origin+this.getLocation().pathname+url}if(0===url.search("^[a-zA-Z]{2,11}:")){return url}if(url.search(/^\//)!==-1){return this.getLocation().origin+url}var regexMatchDir="(.*/)";var base=this.getLocation().origin+this.getLocation().pathname.match(new RegExp(regexMatchDir))[0];return base+url},isUrlToCurrentDomain:function(url){var absoluteUrl=this.toAbsoluteUrl(url);if(!absoluteUrl){return false}var origin=this.getLocation().origin;if(origin===absoluteUrl){return true}if(0===String(absoluteUrl).indexOf(origin)){if(":"===String(absoluteUrl).substr(origin.length,1)){return false}return true}return false},setHrefAttribute:function(node,url){if(!node||!url){return}query.setAnyAttribute(node,"href",url)},shouldIgnoreInteraction:function(targetNode){var hasAttr=query.hasNodeAttribute(targetNode,this.CONTENT_IGNOREINTERACTION_ATTR);var hasClass=query.hasNodeCssClass(targetNode,this.CONTENT_IGNOREINTERACTION_CLASS);return hasAttr||hasClass}};function getCapturlyUrlForOverlay(trackerUrl,apiUrl){if(apiUrl){return apiUrl}trackerUrl=content.toAbsoluteUrl(trackerUrl);if(stringContains(trackerUrl,"?")){var posQuery=trackerUrl.indexOf("?");trackerUrl=trackerUrl.slice(0,posQuery)}if(stringEndsWith(trackerUrl,"capturly.php")){trackerUrl=removeCharactersFromEndOfString(trackerUrl,"capturly.php".length)}else{if(stringEndsWith(trackerUrl,".php")){var lastSlash=trackerUrl.lastIndexOf("/");var includeLastSlash=1;trackerUrl=trackerUrl.slice(0,lastSlash+includeLastSlash)}}if(stringEndsWith(trackerUrl,"/js/")){trackerUrl=removeCharactersFromEndOfString(trackerUrl,"js/".length)}return trackerUrl}function isOverlaySession(configTrackerSiteId){var windowName="Capturly_Overlay";var referrerRegExp=new RegExp("index\\.php\\?module=Overlay&action=startOverlaySession&idSite=([0-9]+)&period=([^&]+)&date=([^&]+)(&segment=.*)?$");var match=referrerRegExp.exec(documentAlias.referrer);if(match){var idsite=match[1];if(idsite!==String(configTrackerSiteId)){return false}var period=match[2],date=match[3],segment=match[4];if(!segment){segment=""}else{if(segment.indexOf("&segment=")===0){segment=segment.substr("&segment=".length)}}windowAlias.name=windowName+"###"+period+"###"+date+"###"+segment}var windowNameParts=windowAlias.name.split("###");return windowNameParts.length===4&&windowNameParts[0]===windowName}function injectOverlayScripts(configTrackerUrl,configApiUrl,configTrackerSiteId){var windowNameParts=windowAlias.name.split("###"),period=windowNameParts[1],date=windowNameParts[2],segment=windowNameParts[3],capturlyUrl=getCapturlyUrlForOverlay(configTrackerUrl,configApiUrl);loadScript(capturlyUrl+"plugins/Overlay/client/client.js?v=1",function(){Capturly_Overlay_Client.initialize(capturlyUrl,configTrackerSiteId,period,date,segment)})}function isInsideAnIframe(){var frameElement;try{frameElement=windowAlias.frameElement}catch(e){return true}if(isDefined(frameElement)){return(frameElement&&String(frameElement.nodeName).toLowerCase()==="iframe")?true:false}try{return windowAlias.self!==windowAlias.top}catch(e2){return true}}function Tracker(trackerUrl,siteId){var registeredHooks={},trackerInstance=this,locationArray=urlFixup(documentAlias.domain,windowAlias.location.href,getReferrer()),domainAlias=domainFixup(locationArray[0]),locationHrefAlias=safeDecodeWrapper(locationArray[1]),configReferrerUrl=safeDecodeWrapper(locationArray[2]),enableJSErrorTracking=false,defaultRequestMethod="GET",configRequestMethod=defaultRequestMethod,defaultRequestContentType="application/x-www-form-urlencoded; charset=UTF-8",configRequestContentType=defaultRequestContentType,configTrackerUrl=trackerUrl||"",configApiUrl="",configAppendToTrackingUrl="",configTrackerSiteId=siteId||"",configUserId="",visitorUUID="",configCustomUrl,configTitle="",configDownloadExtensions=["7z","aac","apk","arc","arj","asf","asx","avi","azw3","bin","csv","deb","dmg","doc","docx","epub","exe","flv","gif","gz","gzip","hqx","ibooks","jar","jpg","jpeg","js","mobi","mp2","mp3","mp4","mpg","mpeg","mov","movie","msi","msp","odb","odf","odg","ods","odt","ogg","ogv","pdf","phps","png","ppt","pptx","qt","qtm","ra","ram","rar","rpm","sea","sit","tar","tbz","tbz2","bz","bz2","tgz","torrent","txt","wav","wma","wmv","wpd","xls","xlsx","xml","z","zip"],configHostsAlias=[domainAlias],configIgnoreClasses=[],configDownloadClasses=[],configLinkClasses=[],configTrackerPause=500,configMinimumVisitTime,configHeartBeatDelay,heartBeatPingIfActivityAlias,configDiscardHashTag,configCustomData,configCampaignNameParameters=["pk_campaign","capturly_campaign","utm_campaign","utm_source","utm_medium"],configCampaignKeywordParameters=["pk_kwd","capturly_kwd","utm_term"],configCookieNamePrefix="_tr_",configVisitorIdUrlParameter="pk_vid",configCookieDomain,configCookiePath,configCookiesDisabled=false,configDoNotTrack,configCountPreRendered,configConversionAttributionFirstReferrer,configVisitorCookieTimeout=33955200000,configSessionCookieTimeout=1800000,configReferralCookieTimeout=15768000000,configPerformanceTrackingEnabled=true,configPerformanceGenerationTime=0,configStoreCustomVariablesInCookie=false,customVariables=false,configCustomRequestContentProcessing,customVariablesPage={},customVariablesEvent={},customDimensions={},customVariableMaximumLength=200,ecommerceItems={},browserFeatures={},trackedContentImpressions=[],isTrackOnlyVisibleContentEnabled=false,timeNextTrackingRequestCanBeExecutedImmediately=false,linkTrackingInstalled=false,linkTrackingEnabled=false,crossDomainTrackingEnabled=false,heartBeatSetUp=false,hadWindowFocusAtLeastOnce=isInsideAnIframe(),lastTrackerRequestTime=null,heartBeatTimeout,lastButton,lastTarget,hash=sha1,domainHash,configIdPageView,numTrackedPageviews=0,configCookiesToDelete=["id","ses","cvar","ref"];try{configTitle=documentAlias.title}catch(e){configTitle=""}function setCookie(cookieName,value,msToExpire,path,domain,secure){if(configCookiesDisabled){return}var expiryDate;if(msToExpire){expiryDate=new Date();expiryDate.setTime(expiryDate.getTime()+msToExpire)}documentAlias.cookie=cookieName+"="+encodeWrapper(value)+(msToExpire?";expires="+expiryDate.toGMTString():"")+";path="+(path||"/")+(domain?";domain="+domain:"")+(secure?";secure":"")}function getCookie(cookieName){if(configCookiesDisabled){return 0}var cookiePattern=new RegExp("(^|;)[ ]*"+cookieName+"=([^;]*)"),cookieMatch=cookiePattern.exec(documentAlias.cookie);return cookieMatch?decodeWrapper(cookieMatch[2]):0}function purify(url){var targetPattern;url=removeUrlParameter(url,configVisitorIdUrlParameter);if(configDiscardHashTag){targetPattern=new RegExp("#.*");return url.replace(targetPattern,"")}return url}function resolveRelativeReference(baseUrl,url){var protocol=getProtocolScheme(url),i;if(protocol){return url}if(url.slice(0,1)==="/"){return getProtocolScheme(baseUrl)+"://"+getHostName(baseUrl)+url}baseUrl=purify(baseUrl);i=baseUrl.indexOf("?");if(i>=0){baseUrl=baseUrl.slice(0,i)}i=baseUrl.lastIndexOf("/");if(i!==baseUrl.length-1){baseUrl=baseUrl.slice(0,i+1)}return baseUrl+url}function isSameHost(hostName,alias){var offset;hostName=String(hostName).toLowerCase();alias=String(alias).toLowerCase();if(hostName===alias){return true}if(alias.slice(0,1)==="."){if(hostName===alias.slice(1)){return true}offset=hostName.length-alias.length;if((offset>0)&&(hostName.slice(offset)===alias)){return true}}return false}function getPathName(url){var parser=document.createElement("a");if(url.indexOf("//")!==0&&url.indexOf("http")!==0){if(url.indexOf("*")===0){url=url.substr(1)}if(url.indexOf(".")===0){url=url.substr(1)}url="http://"+url}parser.href=content.toAbsoluteUrl(url);if(parser.pathname){return parser.pathname}return""}function isSitePath(path,pathAlias){if(!stringStartsWith(pathAlias,"/")){pathAlias="/"+pathAlias}if(!stringStartsWith(path,"/")){path="/"+path}var matchesAnyPath=(pathAlias==="/"||pathAlias==="/*");if(matchesAnyPath){return true}if(path===pathAlias){return true}pathAlias=String(pathAlias).toLowerCase();path=String(path).toLowerCase();if(stringEndsWith(pathAlias,"*")){pathAlias=pathAlias.slice(0,-1);matchesAnyPath=(!pathAlias||pathAlias==="/");if(matchesAnyPath){return true}if(path===pathAlias){return true}return path.indexOf(pathAlias)===0}if(!stringEndsWith(path,"/")){path+="/"}if(!stringEndsWith(pathAlias,"/")){pathAlias+="/"}return path.indexOf(pathAlias)===0}function isSiteHostPath(host,path){var i,alias,configAlias,aliasHost,aliasPath;for(i=0;i<configHostsAlias.length;i++){aliasHost=domainFixup(configHostsAlias[i]);aliasPath=getPathName(configHostsAlias[i]);if(isSameHost(host,aliasHost)&&isSitePath(path,aliasPath)){return true}}return false}function isSiteHostName(hostName){var i,alias,offset;for(i=0;i<configHostsAlias.length;i++){alias=domainFixup(configHostsAlias[i].toLowerCase());if(hostName===alias){return true}if(alias.slice(0,1)==="."){if(hostName===alias.slice(1)){return true}offset=hostName.length-alias.length;if((offset>0)&&(hostName.slice(offset)===alias)){return true}}}return false}function getImage(request,callback){var image=new Image(1,1);image.onload=function(){iterator=0;if(typeof callback==="function"){callback()}};request=request.replace("send_image=0","send_image=1");image.src=configTrackerUrl+(configTrackerUrl.indexOf("?")<0?"?":"&")+request}function sendXmlHttpRequest(request,callback,fallbackToGet){if(!isDefined(fallbackToGet)||null===fallbackToGet){fallbackToGet=true}try{var xhr=windowAlias.XMLHttpRequest?new windowAlias.XMLHttpRequest():windowAlias.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;xhr.open("POST",configTrackerUrl,true);xhr.onreadystatechange=function(){if(this.readyState===4&&!(this.status>=200&&this.status<300)&&fallbackToGet){getImage(request,callback)}else{if(this.readyState===4&&(typeof callback==="function")){callback()}}};xhr.setRequestHeader("Content-Type",configRequestContentType);xhr.send(request)}catch(e){if(fallbackToGet){getImage(request,callback)}}}function setExpireDateTime(delay){var now=new Date();var time=now.getTime()+delay;if(!expireDateTime||time>expireDateTime){expireDateTime=time}}function heartBeatUp(delay){if(heartBeatTimeout||!configHeartBeatDelay){return}heartBeatTimeout=setTimeout(function heartBeat(){heartBeatTimeout=null;if(!hadWindowFocusAtLeastOnce){hadWindowFocusAtLeastOnce=(!documentAlias.hasFocus||documentAlias.hasFocus())}if(!hadWindowFocusAtLeastOnce){heartBeatUp(configHeartBeatDelay);return}if(heartBeatPingIfActivityAlias()){return}var now=new Date(),heartBeatDelay=configHeartBeatDelay-(now.getTime()-lastTrackerRequestTime);heartBeatDelay=Math.min(configHeartBeatDelay,heartBeatDelay);heartBeatUp(heartBeatDelay)},delay||configHeartBeatDelay)}function heartBeatDown(){if(!heartBeatTimeout){return}clearTimeout(heartBeatTimeout);heartBeatTimeout=null}function heartBeatOnFocus(){hadWindowFocusAtLeastOnce=true;if(heartBeatPingIfActivityAlias()){return}heartBeatUp()}function heartBeatOnBlur(){heartBeatDown()}function setUpHeartBeat(){if(heartBeatSetUp||!configHeartBeatDelay){return}heartBeatSetUp=true;addEventListener(windowAlias,"focus",heartBeatOnFocus);addEventListener(windowAlias,"blur",heartBeatOnBlur);heartBeatUp()}function makeSureThereIsAGapAfterFirstTrackingRequestToPreventMultipleVisitorCreation(callback){var now=new Date();var timeNow=now.getTime();lastTrackerRequestTime=timeNow;if(timeNextTrackingRequestCanBeExecutedImmediately&&timeNow<timeNextTrackingRequestCanBeExecutedImmediately){var timeToWait=timeNextTrackingRequestCanBeExecutedImmediately-timeNow;setTimeout(callback,timeToWait);setExpireDateTime(timeToWait+50);timeNextTrackingRequestCanBeExecutedImmediately+=50;return}if(timeNextTrackingRequestCanBeExecutedImmediately===false){var delayInMs=800;timeNextTrackingRequestCanBeExecutedImmediately=timeNow+delayInMs}callback()}function sendRequest(request,delay,callback){if(!configDoNotTrack&&request){makeSureThereIsAGapAfterFirstTrackingRequestToPreventMultipleVisitorCreation(function(){if(configRequestMethod==="POST"||String(request).length>2000){sendXmlHttpRequest(request,callback)}else{getImage(request,callback)}setExpireDateTime(delay)})}if(!heartBeatSetUp){setUpHeartBeat()}else{heartBeatUp()}}function canSendBulkRequest(requests){if(configDoNotTrack){return false}return(requests&&requests.length)}function sendBulkRequest(requests,delay){if(!canSendBulkRequest(requests)){return}var bulk='{"requests":["?'+requests.join('","?')+'"]}';makeSureThereIsAGapAfterFirstTrackingRequestToPreventMultipleVisitorCreation(function(){sendXmlHttpRequest(bulk,null,false);setExpireDateTime(delay)})}function getCookieName(baseName){return configCookieNamePrefix+baseName+"."+configTrackerSiteId+"."+domainHash}function hasCookies(){if(configCookiesDisabled){return"0"}if(!isDefined(navigatorAlias.cookieEnabled)){var testCookieName=getCookieName("testcookie");setCookie(testCookieName,"1");return getCookie(testCookieName)==="1"?"1":"0"}return navigatorAlias.cookieEnabled?"1":"0"}function updateDomainHash(){domainHash=hash((configCookieDomain||domainAlias)+(configCookiePath||"/")).slice(0,4)}function getCustomVariablesFromCookie(){var cookieName=getCookieName("cvar"),cookie=getCookie(cookieName);if(cookie.length){cookie=JSON_CAPTURLY.parse(cookie);if(isObject(cookie)){return cookie}}return{}}function loadCustomVariables(){if(customVariables===false){customVariables=getCustomVariablesFromCookie()}}function generateRandomUuid(){return hash((navigatorAlias.userAgent||"")+(navigatorAlias.platform||"")+JSON_CAPTURLY.stringify(browserFeatures)+(new Date()).getTime()+Math.random()).slice(0,16)}function generateBrowserSpecificId(){return hash((navigatorAlias.userAgent||"")+(navigatorAlias.platform||"")+JSON_CAPTURLY.stringify(browserFeatures)).slice(0,6)}function getCurrentTimestampInSeconds(){return Math.floor((new Date()).getTime()/1000)}function makeCrossDomainDeviceId(){var timestamp=getCurrentTimestampInSeconds();var browserId=generateBrowserSpecificId();var deviceId=String(timestamp)+browserId;return deviceId}function isSameCrossDomainDevice(deviceIdFromUrl){deviceIdFromUrl=String(deviceIdFromUrl);var thisBrowserId=generateBrowserSpecificId();var lengthBrowserId=thisBrowserId.length;var browserIdInUrl=deviceIdFromUrl.substr(-1*lengthBrowserId,lengthBrowserId);var timestampInUrl=parseInt(deviceIdFromUrl.substr(0,deviceIdFromUrl.length-lengthBrowserId),10);if(timestampInUrl&&browserIdInUrl&&browserIdInUrl===thisBrowserId){var currentTimestampInSeconds=getCurrentTimestampInSeconds();var timeoutInSeconds=45;if(currentTimestampInSeconds>=timestampInUrl&&currentTimestampInSeconds<=(timestampInUrl+timeoutInSeconds)){return true}}return false}function getVisitorIdFromUrl(url){if(!crossDomainTrackingEnabled){return""}var visitorIdParam=getUrlParameter(url,configVisitorIdUrlParameter);if(!visitorIdParam){return""}visitorIdParam=String(visitorIdParam);var pattern=new RegExp("^[a-zA-Z0-9]+$");if(visitorIdParam.length===32&&pattern.test(visitorIdParam)){var visitorDevice=visitorIdParam.substr(16,32);if(isSameCrossDomainDevice(visitorDevice)){var visitorId=visitorIdParam.substr(0,16);return visitorId}}return""}function loadVisitorIdCookie(){if(!visitorUUID){visitorUUID=getVisitorIdFromUrl(locationHrefAlias)}var now=new Date(),nowTs=Math.round(now.getTime()/1000),visitorIdCookieName=getCookieName("id"),id=getCookie(visitorIdCookieName),cookieValue,uuid;if(id){cookieValue=id.split(".");cookieValue.unshift("0");if(visitorUUID.length){cookieValue[1]=visitorUUID}return cookieValue}if(visitorUUID.length){uuid=visitorUUID}else{if("0"===hasCookies()){uuid=""}else{uuid=generateRandomUuid()}}cookieValue=["1",uuid,nowTs,0,nowTs,"",""];return cookieValue}function getValuesFromVisitorIdCookie(){var cookieVisitorIdValue=loadVisitorIdCookie(),newVisitor=cookieVisitorIdValue[0],uuid=cookieVisitorIdValue[1],createTs=cookieVisitorIdValue[2],visitCount=cookieVisitorIdValue[3],currentVisitTs=cookieVisitorIdValue[4],lastVisitTs=cookieVisitorIdValue[5];if(!isDefined(cookieVisitorIdValue[6])){cookieVisitorIdValue[6]=""}var lastEcommerceOrderTs=cookieVisitorIdValue[6];return{newVisitor:newVisitor,uuid:uuid,createTs:createTs,visitCount:visitCount,currentVisitTs:currentVisitTs,lastVisitTs:lastVisitTs,lastEcommerceOrderTs:lastEcommerceOrderTs}}function getRemainingVisitorCookieTimeout(){var now=new Date(),nowTs=now.getTime(),cookieCreatedTs=getValuesFromVisitorIdCookie().createTs;var createTs=parseInt(cookieCreatedTs,10);var originalTimeout=(createTs*1000)+configVisitorCookieTimeout-nowTs;return originalTimeout}function setVisitorIdCookie(visitorIdCookieValues){if(!configTrackerSiteId){return}var now=new Date(),nowTs=Math.round(now.getTime()/1000);if(!isDefined(visitorIdCookieValues)){visitorIdCookieValues=getValuesFromVisitorIdCookie()}var cookieValue=visitorIdCookieValues.uuid+"."+visitorIdCookieValues.createTs+"."+visitorIdCookieValues.visitCount+"."+nowTs+"."+visitorIdCookieValues.lastVisitTs+"."+visitorIdCookieValues.lastEcommerceOrderTs;setCookie(getCookieName("id"),cookieValue,getRemainingVisitorCookieTimeout(),configCookiePath,configCookieDomain)}function loadReferrerAttributionCookie(){var cookie=getCookie(getCookieName("ref"));if(cookie.length){try{cookie=JSON_CAPTURLY.parse(cookie);if(isObject(cookie)){return cookie}}catch(ignore){}}return["","",0,""]}function deleteCookie(cookieName,path,domain){setCookie(cookieName,"",-86400,path,domain)}function isPossibleToSetCookieOnDomain(domainToTest){var valueToSet="testvalue";setCookie("test",valueToSet,10000,null,domainToTest);if(getCookie("test")===valueToSet){deleteCookie("test",null,domainToTest);return true}return false}function deleteCookies(){var savedConfigCookiesDisabled=configCookiesDisabled;configCookiesDisabled=false;var index,cookieName;for(index=0;index<configCookiesToDelete.length;index++){cookieName=getCookieName(configCookiesToDelete[index]);if(0!==getCookie(cookieName)){deleteCookie(cookieName,configCookiePath,configCookieDomain)}}configCookiesDisabled=savedConfigCookiesDisabled}function setSiteId(siteId){configTrackerSiteId=siteId;setVisitorIdCookie()}function sortObjectByKeys(value){if(!value||!isObject(value)){return}var keys=[];var key;for(key in value){if(Object.prototype.hasOwnProperty.call(value,key)){keys.push(key)}}var normalized={};keys.sort();var len=keys.length;var i;for(i=0;i<len;i++){normalized[keys[i]]=value[keys[i]]}return normalized}function setSessionCookie(){setCookie(getCookieName("ses"),"*",configSessionCookieTimeout,configCookiePath,configCookieDomain)}function generateUniqueId(){var id="";var chars="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";var charLen=chars.length;var i;for(i=0;i<6;i++){id+=chars.charAt(Math.floor(Math.random()*charLen))}return id}function getRequest(request,customData,pluginMethod,currentEcommerceOrderTs){var i,now=new Date(),nowTs=Math.round(now.getTime()/1000),referralTs,referralUrl,referralUrlMaxLength=1024,currentReferrerHostName,originalReferrerHostName,customVariablesCopy=customVariables,cookieSessionName=getCookieName("ses"),cookieReferrerName=getCookieName("ref"),cookieCustomVariablesName=getCookieName("cvar"),cookieSessionValue=getCookie(cookieSessionName),attributionCookie=loadReferrerAttributionCookie(),currentUrl=configCustomUrl||locationHrefAlias,campaignNameDetected,campaignKeywordDetected;if(configCookiesDisabled){deleteCookies()}if(configDoNotTrack){return""}var cookieVisitorIdValues=getValuesFromVisitorIdCookie();if(!isDefined(currentEcommerceOrderTs)){currentEcommerceOrderTs=""}var charSet=documentAlias.characterSet||documentAlias.charset;if(!charSet||charSet.toLowerCase()==="utf-8"){charSet=null}campaignNameDetected=attributionCookie[0];campaignKeywordDetected=attributionCookie[1];referralTs=attributionCookie[2];referralUrl=attributionCookie[3];if(!cookieSessionValue){var visitDuration=configSessionCookieTimeout/1000;if(!cookieVisitorIdValues.lastVisitTs||(nowTs-cookieVisitorIdValues.lastVisitTs)>visitDuration){cookieVisitorIdValues.visitCount++;cookieVisitorIdValues.lastVisitTs=cookieVisitorIdValues.currentVisitTs}if(!configConversionAttributionFirstReferrer||!campaignNameDetected.length){for(i in configCampaignNameParameters){if(Object.prototype.hasOwnProperty.call(configCampaignNameParameters,i)){campaignNameDetected=getUrlParameter(currentUrl,configCampaignNameParameters[i]);if(campaignNameDetected.length){break}}}for(i in configCampaignKeywordParameters){if(Object.prototype.hasOwnProperty.call(configCampaignKeywordParameters,i)){campaignKeywordDetected=getUrlParameter(currentUrl,configCampaignKeywordParameters[i]);if(campaignKeywordDetected.length){break}}}}currentReferrerHostName=getHostName(configReferrerUrl);originalReferrerHostName=referralUrl.length?getHostName(referralUrl):"";if(currentReferrerHostName.length&&!isSiteHostName(currentReferrerHostName)&&(!configConversionAttributionFirstReferrer||!originalReferrerHostName.length||isSiteHostName(originalReferrerHostName))){referralUrl=configReferrerUrl}if(referralUrl.length||campaignNameDetected.length){referralTs=nowTs;attributionCookie=[campaignNameDetected,campaignKeywordDetected,referralTs,purify(referralUrl.slice(0,referralUrlMaxLength))];setCookie(cookieReferrerName,JSON_CAPTURLY.stringify(attributionCookie),configReferralCookieTimeout,configCookiePath,configCookieDomain)}}request+="&idsite="+configTrackerSiteId+"&rec=1&r="+String(Math.random()).slice(2,8)+"&h="+now.getHours()+"&m="+now.getMinutes()+"&s="+now.getSeconds()+"&url="+encodeWrapper(purify(currentUrl))+(configReferrerUrl.length?"&urlref="+encodeWrapper(purify(configReferrerUrl)):"")+((configUserId&&configUserId.length)?"&uid="+encodeWrapper(configUserId):"")+"&_id="+cookieVisitorIdValues.uuid+"&_idts="+cookieVisitorIdValues.createTs+"&_idvc="+cookieVisitorIdValues.visitCount+"&_idn="+cookieVisitorIdValues.newVisitor+(campaignNameDetected.length?"&_rcn="+encodeWrapper(campaignNameDetected):"")+(campaignKeywordDetected.length?"&_rck="+encodeWrapper(campaignKeywordDetected):"")+"&_refts="+referralTs+"&_viewts="+cookieVisitorIdValues.lastVisitTs+(String(cookieVisitorIdValues.lastEcommerceOrderTs).length?"&_ects="+cookieVisitorIdValues.lastEcommerceOrderTs:"")+(String(referralUrl).length?"&_ref="+encodeWrapper(purify(referralUrl.slice(0,referralUrlMaxLength))):"")+(charSet?"&cs="+encodeWrapper(charSet):"")+"&send_image=0";for(i in browserFeatures){if(Object.prototype.hasOwnProperty.call(browserFeatures,i)){request+="&"+i+"="+browserFeatures[i]}}var customDimensionIdsAlreadyHandled=[];if(customData){for(i in customData){if(Object.prototype.hasOwnProperty.call(customData,i)&&/^dimension\d+$/.test(i)){var index=i.replace("dimension","");customDimensionIdsAlreadyHandled.push(parseInt(index,10));customDimensionIdsAlreadyHandled.push(String(index));request+="&"+i+"="+customData[i];delete customData[i]}}}if(customData&&isObjectEmpty(customData)){customData=null}for(i in customDimensions){if(Object.prototype.hasOwnProperty.call(customDimensions,i)){var isNotSetYet=(-1===indexOfArray(customDimensionIdsAlreadyHandled,i));if(isNotSetYet){request+="&dimension"+i+"="+customDimensions[i]}}}if(customData){request+="&data="+encodeWrapper(JSON_CAPTURLY.stringify(customData))}else{if(configCustomData){request+="&data="+encodeWrapper(JSON_CAPTURLY.stringify(configCustomData))}}function appendCustomVariablesToRequest(customVariables,parameterName){var customVariablesStringified=JSON_CAPTURLY.stringify(customVariables);if(customVariablesStringified.length>2){return"&"+parameterName+"="+encodeWrapper(customVariablesStringified)}return""}var sortedCustomVarPage=sortObjectByKeys(customVariablesPage);var sortedCustomVarEvent=sortObjectByKeys(customVariablesEvent);request+=appendCustomVariablesToRequest(sortedCustomVarPage,"cvar");request+=appendCustomVariablesToRequest(sortedCustomVarEvent,"e_cvar");if(customVariables){request+=appendCustomVariablesToRequest(customVariables,"_cvar");for(i in customVariablesCopy){if(Object.prototype.hasOwnProperty.call(customVariablesCopy,i)){if(customVariables[i][0]===""||customVariables[i][1]===""){delete customVariables[i]}}}if(configStoreCustomVariablesInCookie){setCookie(cookieCustomVariablesName,JSON_CAPTURLY.stringify(customVariables),configSessionCookieTimeout,configCookiePath,configCookieDomain)}}if(configPerformanceTrackingEnabled){if(configPerformanceGenerationTime){request+="&gt_ms="+configPerformanceGenerationTime}else{if(performanceAlias&&performanceAlias.timing&&performanceAlias.timing.requestStart&&performanceAlias.timing.responseEnd){request+="&gt_ms="+(performanceAlias.timing.responseEnd-performanceAlias.timing.requestStart)}}}if(configIdPageView){request+="&pv_id="+configIdPageView}cookieVisitorIdValues.lastEcommerceOrderTs=isDefined(currentEcommerceOrderTs)&&String(currentEcommerceOrderTs).length?currentEcommerceOrderTs:cookieVisitorIdValues.lastEcommerceOrderTs;setVisitorIdCookie(cookieVisitorIdValues);setSessionCookie();request+=executePluginMethod(pluginMethod,{tracker:trackerInstance,request:request});if(configAppendToTrackingUrl.length){request+="&"+configAppendToTrackingUrl}if(isFunction(configCustomRequestContentProcessing)){request=configCustomRequestContentProcessing(request)}return request}heartBeatPingIfActivityAlias=function heartBeatPingIfActivity(){var now=new Date();if(lastTrackerRequestTime+configHeartBeatDelay<=now.getTime()){var requestPing=getRequest("ping=1",null,"ping");sendRequest(requestPing,configTrackerPause);return true}return false};function logEcommerce(orderId,grandTotal,subTotal,tax,shipping,discount){var request="idgoal=0",lastEcommerceOrderTs,now=new Date(),items=[],sku,isEcommerceOrder=String(orderId).length;if(isEcommerceOrder){request+="&ec_id="+encodeWrapper(orderId);lastEcommerceOrderTs=Math.round(now.getTime()/1000)}request+="&revenue="+grandTotal;if(String(subTotal).length){request+="&ec_st="+subTotal}if(String(tax).length){request+="&ec_tx="+tax}if(String(shipping).length){request+="&ec_sh="+shipping}if(String(discount).length){request+="&ec_dt="+discount}if(ecommerceItems){for(sku in ecommerceItems){if(Object.prototype.hasOwnProperty.call(ecommerceItems,sku)){if(!isDefined(ecommerceItems[sku][1])){ecommerceItems[sku][1]=""}if(!isDefined(ecommerceItems[sku][2])){ecommerceItems[sku][2]=""}if(!isDefined(ecommerceItems[sku][3])||String(ecommerceItems[sku][3]).length===0){ecommerceItems[sku][3]=0}if(!isDefined(ecommerceItems[sku][4])||String(ecommerceItems[sku][4]).length===0){ecommerceItems[sku][4]=1}items.push(ecommerceItems[sku])}}request+="&ec_items="+encodeWrapper(JSON_CAPTURLY.stringify(items))}request=getRequest(request,configCustomData,"ecommerce",lastEcommerceOrderTs);sendRequest(request,configTrackerPause);if(isEcommerceOrder){ecommerceItems={}}}function logEcommerceOrder(orderId,grandTotal,subTotal,tax,shipping,discount){if(String(orderId).length&&isDefined(grandTotal)){logEcommerce(orderId,grandTotal,subTotal,tax,shipping,discount)}}function logEcommerceCartUpdate(grandTotal){if(isDefined(grandTotal)){logEcommerce("",grandTotal,"","","","")}}function logPageView(customTitle,customData,callback){configIdPageView=generateUniqueId();var request=getRequest("action_name="+encodeWrapper(titleFixup(customTitle||configTitle)),customData,"log");sendRequest(request,configTrackerPause,callback)}function getClassesRegExp(configClasses,defaultClass){var i,classesRegExp="(^| )(capturly[_-]"+defaultClass;if(configClasses){for(i=0;i<configClasses.length;i++){classesRegExp+="|"+configClasses[i]}}classesRegExp+=")( |$)";return new RegExp(classesRegExp)}function startsUrlWithTrackerUrl(url){return(configTrackerUrl&&url&&0===String(url).indexOf(configTrackerUrl))}function getLinkType(className,href,isInLink,hasDownloadAttribute){if(startsUrlWithTrackerUrl(href)){return 0}var downloadPattern=getClassesRegExp(configDownloadClasses,"download"),linkPattern=getClassesRegExp(configLinkClasses,"link"),downloadExtensionsPattern=new RegExp("\\.("+configDownloadExtensions.join("|")+")([?&#]|$)","i");if(linkPattern.test(className)){return"link"}if(hasDownloadAttribute||downloadPattern.test(className)||downloadExtensionsPattern.test(href)){return"download"}if(isInLink){return 0}return"link"}function getSourceElement(sourceElement){var parentElement;parentElement=sourceElement.parentNode;while(parentElement!==null&&isDefined(parentElement)){if(query.isLinkElement(sourceElement)){break}sourceElement=parentElement;parentElement=sourceElement.parentNode}return sourceElement}function getLinkIfShouldBeProcessed(sourceElement){sourceElement=getSourceElement(sourceElement);if(!query.hasNodeAttribute(sourceElement,"href")){return}if(!isDefined(sourceElement.href)){return}var href=query.getAttributeValueFromNode(sourceElement,"href");if(startsUrlWithTrackerUrl(href)){return}var originalSourcePath=sourceElement.pathname||getPathName(sourceElement.href);var originalSourceHostName=sourceElement.hostname||getHostName(sourceElement.href);var sourceHostName=originalSourceHostName.toLowerCase();var sourceHref=sourceElement.href.replace(originalSourceHostName,sourceHostName);var scriptProtocol=new RegExp("^(javascript|vbscript|jscript|mocha|livescript|ecmascript|mailto|tel):","i");if(!scriptProtocol.test(sourceHref)){var linkType=getLinkType(sourceElement.className,sourceHref,isSiteHostPath(sourceHostName,originalSourcePath),query.hasNodeAttribute(sourceElement,"download"));if(linkType){return{type:linkType,href:sourceHref}}}}function buildContentInteractionRequest(interaction,name,piece,target){var params=content.buildInteractionRequestParams(interaction,name,piece,target);if(!params){return}return getRequest(params,null,"contentInteraction")}function buildContentInteractionTrackingRedirectUrl(url,contentInteraction,contentName,contentPiece,contentTarget){if(!isDefined(url)){return}if(startsUrlWithTrackerUrl(url)){return url}var redirectUrl=content.toAbsoluteUrl(url);var request="redirecturl="+encodeWrapper(redirectUrl)+"&";request+=buildContentInteractionRequest(contentInteraction,contentName,contentPiece,(contentTarget||url));var separator="&";if(configTrackerUrl.indexOf("?")<0){separator="?"}return configTrackerUrl+separator+request}function isNodeAuthorizedToTriggerInteraction(contentNode,interactedNode){if(!contentNode||!interactedNode){return false}var targetNode=content.findTargetNode(contentNode);if(content.shouldIgnoreInteraction(targetNode)){return false}targetNode=content.findTargetNodeNoDefault(contentNode);if(targetNode&&!containsNodeElement(targetNode,interactedNode)){return false}return true}function getContentInteractionToRequestIfPossible(anyNode,interaction,fallbackTarget){if(!anyNode){return}var contentNode=content.findParentContentNode(anyNode);if(!contentNode){return}if(!isNodeAuthorizedToTriggerInteraction(contentNode,anyNode)){return}var contentBlock=content.buildContentBlock(contentNode);if(!contentBlock){return}if(!contentBlock.target&&fallbackTarget){contentBlock.target=fallbackTarget}return content.buildInteractionRequestParams(interaction,contentBlock.name,contentBlock.piece,contentBlock.target)}function wasContentImpressionAlreadyTracked(contentBlock){if(!trackedContentImpressions||!trackedContentImpressions.length){return false}var index,trackedContent;for(index=0;index<trackedContentImpressions.length;index++){trackedContent=trackedContentImpressions[index];if(trackedContent&&trackedContent.name===contentBlock.name&&trackedContent.piece===contentBlock.piece&&trackedContent.target===contentBlock.target){return true}}return false}function replaceHrefIfInternalLink(contentBlock){if(!contentBlock){return false}var targetNode=content.findTargetNode(contentBlock);if(!targetNode||content.shouldIgnoreInteraction(targetNode)){return false}var link=getLinkIfShouldBeProcessed(targetNode);if(linkTrackingEnabled&&link&&link.type){return false}if(query.isLinkElement(targetNode)&&query.hasNodeAttributeWithValue(targetNode,"href")){var url=String(query.getAttributeValueFromNode(targetNode,"href"));if(0===url.indexOf("#")){return false}if(startsUrlWithTrackerUrl(url)){return true}if(!content.isUrlToCurrentDomain(url)){return false}var block=content.buildContentBlock(contentBlock);if(!block){return}var contentName=block.name;var contentPiece=block.piece;var contentTarget=block.target;if(!query.hasNodeAttributeWithValue(targetNode,content.CONTENT_TARGET_ATTR)||targetNode.wasContentTargetAttrReplaced){targetNode.wasContentTargetAttrReplaced=true;contentTarget=content.toAbsoluteUrl(url);query.setAnyAttribute(targetNode,content.CONTENT_TARGET_ATTR,contentTarget)}var targetUrl=buildContentInteractionTrackingRedirectUrl(url,"click",contentName,contentPiece,contentTarget);content.setHrefAttribute(targetNode,targetUrl);return true}return false}function replaceHrefsIfInternalLink(contentNodes){if(!contentNodes||!contentNodes.length){return}var index;for(index=0;index<contentNodes.length;index++){replaceHrefIfInternalLink(contentNodes[index])}}function trackContentImpressionClickInteraction(targetNode){return function(event){if(!targetNode){return}var contentBlock=content.findParentContentNode(targetNode);var interactedElement;if(event){interactedElement=event.target||event.srcElement}if(!interactedElement){interactedElement=targetNode}if(!isNodeAuthorizedToTriggerInteraction(contentBlock,interactedElement)){return}setExpireDateTime(configTrackerPause);if(query.isLinkElement(targetNode)&&query.hasNodeAttributeWithValue(targetNode,"href")&&query.hasNodeAttributeWithValue(targetNode,content.CONTENT_TARGET_ATTR)){var href=query.getAttributeValueFromNode(targetNode,"href");if(!startsUrlWithTrackerUrl(href)&&targetNode.wasContentTargetAttrReplaced){query.setAnyAttribute(targetNode,content.CONTENT_TARGET_ATTR,"")}}var link=getLinkIfShouldBeProcessed(targetNode);if(linkTrackingInstalled&&link&&link.type){return link.type}if(replaceHrefIfInternalLink(contentBlock)){return"href"}var block=content.buildContentBlock(contentBlock);if(!block){return}var contentName=block.name;var contentPiece=block.piece;var contentTarget=block.target;var request=buildContentInteractionRequest("click",contentName,contentPiece,contentTarget);sendRequest(request,configTrackerPause);return request}}function setupInteractionsTracking(contentNodes){if(!contentNodes||!contentNodes.length){return}var index,targetNode;for(index=0;index<contentNodes.length;index++){targetNode=content.findTargetNode(contentNodes[index]);if(targetNode&&!targetNode.contentInteractionTrackingSetupDone){targetNode.contentInteractionTrackingSetupDone=true;addEventListener(targetNode,"click",trackContentImpressionClickInteraction(targetNode))}}}function buildContentImpressionsRequests(contents,contentNodes){if(!contents||!contents.length){return[]}var index,request;for(index=0;index<contents.length;index++){if(wasContentImpressionAlreadyTracked(contents[index])){contents.splice(index,1);index--}else{trackedContentImpressions.push(contents[index])}}if(!contents||!contents.length){return[]}replaceHrefsIfInternalLink(contentNodes);setupInteractionsTracking(contentNodes);var requests=[];for(index=0;index<contents.length;index++){request=getRequest(content.buildImpressionRequestParams(contents[index].name,contents[index].piece,contents[index].target),undefined,"contentImpressions");if(request){requests.push(request)}}return requests}function getContentImpressionsRequestsFromNodes(contentNodes){var contents=content.collectContent(contentNodes);return buildContentImpressionsRequests(contents,contentNodes)}function getCurrentlyVisibleContentImpressionsRequestsIfNotTrackedYet(contentNodes){if(!contentNodes||!contentNodes.length){return[]}var index;for(index=0;index<contentNodes.length;index++){if(!content.isNodeVisible(contentNodes[index])){contentNodes.splice(index,1);index--}}if(!contentNodes||!contentNodes.length){return[]}return getContentImpressionsRequestsFromNodes(contentNodes)}function buildContentImpressionRequest(contentName,contentPiece,contentTarget){var params=content.buildImpressionRequestParams(contentName,contentPiece,contentTarget);return getRequest(params,null,"contentImpression")}function buildContentInteractionRequestNode(node,contentInteraction){if(!node){return}var contentNode=content.findParentContentNode(node);var contentBlock=content.buildContentBlock(contentNode);if(!contentBlock){return}if(!contentInteraction){contentInteraction="Unknown"}return buildContentInteractionRequest(contentInteraction,contentBlock.name,contentBlock.piece,contentBlock.target)}function buildEventRequest(category,action,name,value){return"e_c="+encodeWrapper(category)+"&e_a="+encodeWrapper(action)+(isDefined(name)?"&e_n="+encodeWrapper(name):"")+(isDefined(value)?"&e_v="+encodeWrapper(value):"")}function logEvent(category,action,name,value,customData,callback){if(String(category).length===0||String(action).length===0){return false}var request=getRequest(buildEventRequest(category,action,name,value),customData,"event");sendRequest(request,configTrackerPause,callback)}function logSiteSearch(keyword,category,resultsCount,customData){var request=getRequest("search="+encodeWrapper(keyword)+(category?"&search_cat="+encodeWrapper(category):"")+(isDefined(resultsCount)?"&search_count="+resultsCount:""),customData,"sitesearch");sendRequest(request,configTrackerPause)}function logGoal(idGoal,customRevenue,customData){var request=getRequest("idgoal="+idGoal+(customRevenue?"&revenue="+customRevenue:""),customData,"goal");sendRequest(request,configTrackerPause)}function logLink(url,linkType,customData,callback,sourceElement){var linkParams=linkType+"="+encodeWrapper(purify(url));var interaction=getContentInteractionToRequestIfPossible(sourceElement,"click",url);if(interaction){linkParams+="&"+interaction}var request=getRequest(linkParams,customData,"link");sendRequest(request,configTrackerPause,callback)}function prefixPropertyName(prefix,propertyName){if(prefix!==""){return prefix+propertyName.charAt(0).toUpperCase()+propertyName.slice(1)}return propertyName}function trackCallback(callback){var isPreRendered,i,prefixes=["","webkit","ms","moz"],prefix;if(!configCountPreRendered){for(i=0;i<prefixes.length;i++){prefix=prefixes[i];if(Object.prototype.hasOwnProperty.call(documentAlias,prefixPropertyName(prefix,"hidden"))){if(documentAlias[prefixPropertyName(prefix,"visibilityState")]==="prerender"){isPreRendered=true}break}}}if(isPreRendered){addEventListener(documentAlias,prefix+"visibilitychange",function ready(){documentAlias.removeEventListener(prefix+"visibilitychange",ready,false);callback()});return}callback()}function replaceHrefForCrossDomainLink(element){if(!element){return}if(!query.hasNodeAttribute(element,"href")){return}var link=query.getAttributeValueFromNode(element,"href");if(!link||startsUrlWithTrackerUrl(link)){return}link=removeUrlParameter(link,configVisitorIdUrlParameter);if(link.indexOf("?")>0){link+="&"}else{link+="?"}var visitorId=getValuesFromVisitorIdCookie().uuid;var deviceId=makeCrossDomainDeviceId();link=addUrlParameter(link,configVisitorIdUrlParameter,visitorId+deviceId);query.setAnyAttribute(element,"href",link)}function isLinkToDifferentDomainButSameCapturlyWebsite(element){var targetLink=query.getAttributeValueFromNode(element,"href");if(!targetLink){return false}targetLink=String(targetLink);var isOutlink=targetLink.indexOf("//")===0||targetLink.indexOf("http://")===0||targetLink.indexOf("https://")===0;if(!isOutlink){return false}var originalSourcePath=element.pathname||getPathName(element.href);var originalSourceHostName=(element.hostname||getHostName(element.href)).toLowerCase();if(isSiteHostPath(originalSourceHostName,originalSourcePath)){if(!isSameHost(domainAlias,domainFixup(originalSourceHostName))){return true}return false}return false}function processClick(sourceElement){var link=getLinkIfShouldBeProcessed(sourceElement);if(link&&link.type){link.href=safeDecodeWrapper(link.href);logLink(link.href,link.type,undefined,null,sourceElement);return}if(crossDomainTrackingEnabled){sourceElement=getSourceElement(sourceElement);if(isLinkToDifferentDomainButSameCapturlyWebsite(sourceElement)){replaceHrefForCrossDomainLink(sourceElement)}}}function isIE8orOlder(){return documentAlias.all&&!documentAlias.addEventListener}function getKeyCodeFromEvent(event){var which=event.which;var typeOfEventButton=(typeof event.button);if(!which&&typeOfEventButton!=="undefined"){if(isIE8orOlder()){if(event.button&1){which=1}else{if(event.button&2){which=3}else{if(event.button&4){which=2}}}}else{if(event.button===0||event.button==="0"){which=1}else{if(event.button&1){which=2}else{if(event.button&2){which=3}}}}}return which}function getNameOfClickedButton(event){switch(getKeyCodeFromEvent(event)){case 1:return"left";case 2:return"middle";case 3:return"right"}}function getTargetElementFromEvent(event){return event.target||event.srcElement}function clickHandler(enable){return function(event){event=event||windowAlias.event;var button=getNameOfClickedButton(event);var target=getTargetElementFromEvent(event);if(event.type==="click"){var ignoreClick=false;if(enable&&button==="middle"){ignoreClick=true}if(target&&!ignoreClick){processClick(target)}}else{if(event.type==="mousedown"){if(button==="middle"&&target){lastButton=button;lastTarget=target}else{lastButton=lastTarget=null}}else{if(event.type==="mouseup"){if(button===lastButton&&target===lastTarget){processClick(target)}lastButton=lastTarget=null}else{if(event.type==="contextmenu"){processClick(target)}}}}}}function addClickListener(element,enable){var enableType=typeof enable;if(enableType==="undefined"){enable=true}addEventListener(element,"click",clickHandler(enable),false);if(enable){addEventListener(element,"mouseup",clickHandler(enable),false);addEventListener(element,"mousedown",clickHandler(enable),false);addEventListener(element,"contextmenu",clickHandler(enable),false)}}function addClickListeners(enable,trackerInstance){linkTrackingInstalled=true;var i,ignorePattern=getClassesRegExp(configIgnoreClasses,"ignore"),linkElements=documentAlias.links,linkElement=null,trackerType=null;if(linkElements){for(i=0;i<linkElements.length;i++){linkElement=linkElements[i];if(!ignorePattern.test(linkElement.className)){trackerType=typeof linkElement.capturlyTrackers;if("undefined"===trackerType){linkElement.capturlyTrackers=[]}if(-1===indexOfArray(linkElement.capturlyTrackers,trackerInstance)){linkElement.capturlyTrackers.push(trackerInstance);addClickListener(linkElement,enable)}}}}}function enableTrackOnlyVisibleContent(checkOnSroll,timeIntervalInMs,tracker){if(isTrackOnlyVisibleContentEnabled){return true}isTrackOnlyVisibleContentEnabled=true;var didScroll=false;var events,index;function setDidScroll(){didScroll=true}trackCallbackOnLoad(function(){function checkContent(intervalInMs){setTimeout(function(){if(!isTrackOnlyVisibleContentEnabled){return}didScroll=false;tracker.trackVisibleContentImpressions();checkContent(intervalInMs)},intervalInMs)}function checkContentIfDidScroll(intervalInMs){setTimeout(function(){if(!isTrackOnlyVisibleContentEnabled){return}if(didScroll){didScroll=false;tracker.trackVisibleContentImpressions()}checkContentIfDidScroll(intervalInMs)},intervalInMs)}if(checkOnSroll){events=["scroll","resize"];for(index=0;index<events.length;index++){if(documentAlias.addEventListener){documentAlias.addEventListener(events[index],setDidScroll)}else{windowAlias.attachEvent("on"+events[index],setDidScroll)}}checkContentIfDidScroll(100)}if(timeIntervalInMs&&timeIntervalInMs>0){timeIntervalInMs=parseInt(timeIntervalInMs,10);checkContent(timeIntervalInMs)}})}function detectBrowserFeatures(){var i,mimeType,pluginMap={pdf:"application/pdf",qt:"video/quicktime",realp:"audio/x-pn-realaudio-plugin",wma:"application/x-mplayer2",dir:"application/x-director",fla:"application/x-shockwave-flash",java:"application/x-java-vm",gears:"application/x-googlegears",ag:"application/x-silverlight"};if(!((new RegExp("MSIE")).test(navigatorAlias.userAgent))){if(navigatorAlias.mimeTypes&&navigatorAlias.mimeTypes.length){for(i in pluginMap){if(Object.prototype.hasOwnProperty.call(pluginMap,i)){mimeType=navigatorAlias.mimeTypes[pluginMap[i]];browserFeatures[i]=(mimeType&&mimeType.enabledPlugin)?"1":"0"}}}if(typeof navigator.javaEnabled!=="unknown"&&isDefined(navigatorAlias.javaEnabled)&&navigatorAlias.javaEnabled()){browserFeatures.java="1"}if(isFunction(windowAlias.GearsFactory)){browserFeatures.gears="1"}browserFeatures.cookie=hasCookies()}var width=parseInt(screenAlias.width,10);var height=parseInt(screenAlias.height,10);browserFeatures.res=parseInt(width,10)+"x"+parseInt(height,10)}function registerHook(hookName,userHook){var hookObj=null;if(isString(hookName)&&!isDefined(registeredHooks[hookName])&&userHook){if(isObject(userHook)){hookObj=userHook}else{if(isString(userHook)){try{eval("hookObj ="+userHook)}catch(ignore){}}}registeredHooks[hookName]=hookObj}return hookObj}detectBrowserFeatures();updateDomainHash();setVisitorIdCookie();executePluginMethod("run",null,registerHook);this.hook=registeredHooks;this.getHook=function(hookName){return registeredHooks[hookName]};this.getQuery=function(){return query};this.getContent=function(){return content};this.buildContentImpressionRequest=buildContentImpressionRequest;this.buildContentInteractionRequest=buildContentInteractionRequest;this.buildContentInteractionRequestNode=buildContentInteractionRequestNode;this.buildContentInteractionTrackingRedirectUrl=buildContentInteractionTrackingRedirectUrl;this.getContentImpressionsRequestsFromNodes=getContentImpressionsRequestsFromNodes;this.getCurrentlyVisibleContentImpressionsRequestsIfNotTrackedYet=getCurrentlyVisibleContentImpressionsRequestsIfNotTrackedYet;this.trackCallbackOnLoad=trackCallbackOnLoad;this.trackCallbackOnReady=trackCallbackOnReady;this.buildContentImpressionsRequests=buildContentImpressionsRequests;this.wasContentImpressionAlreadyTracked=wasContentImpressionAlreadyTracked;this.appendContentInteractionToRequestIfPossible=getContentInteractionToRequestIfPossible;this.setupInteractionsTracking=setupInteractionsTracking;this.trackContentImpressionClickInteraction=trackContentImpressionClickInteraction;this.internalIsNodeVisible=isVisible;this.isNodeAuthorizedToTriggerInteraction=isNodeAuthorizedToTriggerInteraction;this.replaceHrefIfInternalLink=replaceHrefIfInternalLink;this.getDomains=function(){return configHostsAlias};this.getConfigIdPageView=function(){return configIdPageView};this.getConfigDownloadExtensions=function(){return configDownloadExtensions};this.enableTrackOnlyVisibleContent=function(checkOnScroll,timeIntervalInMs){return enableTrackOnlyVisibleContent(checkOnScroll,timeIntervalInMs,this)};this.clearTrackedContentImpressions=function(){trackedContentImpressions=[]};this.getTrackedContentImpressions=function(){return trackedContentImpressions};this.clearEnableTrackOnlyVisibleContent=function(){isTrackOnlyVisibleContentEnabled=false};this.disableLinkTracking=function(){linkTrackingInstalled=false;linkTrackingEnabled=false};this.getConfigVisitorCookieTimeout=function(){return configVisitorCookieTimeout};this.removeAllAsyncTrackersButFirst=function(){var firstTracker=asyncTrackers[0];asyncTrackers=[firstTracker]};this.getRemainingVisitorCookieTimeout=getRemainingVisitorCookieTimeout;this.getVisitorId=function(){return getValuesFromVisitorIdCookie().uuid};this.getVisitorInfo=function(){return loadVisitorIdCookie()};this.getAttributionInfo=function(){return loadReferrerAttributionCookie()};this.getAttributionCampaignName=function(){return loadReferrerAttributionCookie()[0]};this.getAttributionCampaignKeyword=function(){return loadReferrerAttributionCookie()[1]};this.getAttributionReferrerTimestamp=function(){return loadReferrerAttributionCookie()[2]};this.getAttributionReferrerUrl=function(){return loadReferrerAttributionCookie()[3]};this.setTrackerUrl=function(trackerUrl){configTrackerUrl=trackerUrl};this.getTrackerUrl=function(){return configTrackerUrl};this.getCapturlyUrl=function(){return getCapturlyUrlForOverlay(this.getTrackerUrl(),configApiUrl)};this.addTracker=function(capturlyUrl,siteId){if(!siteId){throw new Error("A siteId must be given to add a new tracker")}if(!isDefined(capturlyUrl)||null===capturlyUrl){capturlyUrl=this.getTrackerUrl()}var tracker=new Tracker(capturlyUrl,siteId);asyncTrackers.push(tracker);return tracker};this.getSiteId=function(){return configTrackerSiteId};this.setSiteId=function(siteId){setSiteId(siteId)};this.setUserId=function(userId){if(!isDefined(userId)||!userId.length){return}configUserId=userId;visitorUUID=hash(configUserId).substr(0,16)};this.getUserId=function(){return configUserId};this.setCustomData=function(key_or_obj,opt_value){if(isObject(key_or_obj)){configCustomData=key_or_obj}else{if(!configCustomData){configCustomData={}}configCustomData[key_or_obj]=opt_value}};this.getCustomData=function(){return configCustomData};this.setCustomRequestProcessing=function(customRequestContentProcessingLogic){configCustomRequestContentProcessing=customRequestContentProcessingLogic};this.appendToTrackingUrl=function(queryString){configAppendToTrackingUrl=queryString};this.getRequest=function(request){return getRequest(request)};this.addPlugin=function(pluginName,pluginObj){plugins[pluginName]=pluginObj};this.setCustomDimension=function(customDimensionId,value){customDimensionId=parseInt(customDimensionId,10);if(customDimensionId>0){if(!isDefined(value)){value=""}if(!isString(value)){value=String(value)}customDimensions[customDimensionId]=value}};this.getCustomDimension=function(customDimensionId){customDimensionId=parseInt(customDimensionId,10);if(customDimensionId>0&&Object.prototype.hasOwnProperty.call(customDimensions,customDimensionId)){return customDimensions[customDimensionId]}};this.deleteCustomDimension=function(customDimensionId){customDimensionId=parseInt(customDimensionId,10);if(customDimensionId>0){delete customDimensions[customDimensionId]}};this.setCustomVariable=function(index,name,value,scope){var toRecord;if(!isDefined(scope)){scope="visit"}if(!isDefined(name)){return}if(!isDefined(value)){value=""}if(index>0){name=!isString(name)?String(name):name;value=!isString(value)?String(value):value;toRecord=[name.slice(0,customVariableMaximumLength),value.slice(0,customVariableMaximumLength)];if(scope==="visit"||scope===2){loadCustomVariables();customVariables[index]=toRecord}else{if(scope==="page"||scope===3){customVariablesPage[index]=toRecord}else{if(scope==="event"){customVariablesEvent[index]=toRecord}}}}};this.getCustomVariable=function(index,scope){var cvar;if(!isDefined(scope)){scope="visit"}if(scope==="page"||scope===3){cvar=customVariablesPage[index]}else{if(scope==="event"){cvar=customVariablesEvent[index]}else{if(scope==="visit"||scope===2){loadCustomVariables();cvar=customVariables[index]}}}if(!isDefined(cvar)||(cvar&&cvar[0]==="")){return false}return cvar};this.deleteCustomVariable=function(index,scope){if(this.getCustomVariable(index,scope)){this.setCustomVariable(index,"","",scope)}};this.deleteCustomVariables=function(scope){if(scope==="page"||scope===3){customVariablesPage={}}else{if(scope==="event"){customVariablesEvent={}}else{if(scope==="visit"||scope===2){customVariables={}}}}};this.storeCustomVariablesInCookie=function(){configStoreCustomVariablesInCookie=true};this.setLinkTrackingTimer=function(delay){configTrackerPause=delay};this.getLinkTrackingTimer=function(){return configTrackerPause};this.setDownloadExtensions=function(extensions){if(isString(extensions)){extensions=extensions.split("|")}configDownloadExtensions=extensions};this.addDownloadExtensions=function(extensions){var i;if(isString(extensions)){extensions=extensions.split("|")}for(i=0;i<extensions.length;i++){configDownloadExtensions.push(extensions[i])}};this.removeDownloadExtensions=function(extensions){var i,newExtensions=[];if(isString(extensions)){extensions=extensions.split("|")}for(i=0;i<configDownloadExtensions.length;i++){if(indexOfArray(extensions,configDownloadExtensions[i])===-1){newExtensions.push(configDownloadExtensions[i])}}configDownloadExtensions=newExtensions};this.setDomains=function(hostsAlias){configHostsAlias=isString(hostsAlias)?[hostsAlias]:hostsAlias;var hasDomainAliasAlready=false,i=0,alias;for(i;i<configHostsAlias.length;i++){alias=String(configHostsAlias[i]);if(isSameHost(domainAlias,domainFixup(alias))){hasDomainAliasAlready=true;break}var pathName=getPathName(alias);if(pathName&&pathName!=="/"&&pathName!=="/*"){hasDomainAliasAlready=true;break}}if(!hasDomainAliasAlready){configHostsAlias.push(domainAlias)}};this.enableCrossDomainLinking=function(){crossDomainTrackingEnabled=true};this.disableCrossDomainLinking=function(){crossDomainTrackingEnabled=false};this.isCrossDomainLinkingEnabled=function(){return crossDomainTrackingEnabled};this.setIgnoreClasses=function(ignoreClasses){configIgnoreClasses=isString(ignoreClasses)?[ignoreClasses]:ignoreClasses};this.setRequestMethod=function(method){configRequestMethod=method||defaultRequestMethod};this.setRequestContentType=function(requestContentType){configRequestContentType=requestContentType||defaultRequestContentType};this.setReferrerUrl=function(url){configReferrerUrl=url};this.setCustomUrl=function(url){configCustomUrl=resolveRelativeReference(locationHrefAlias,url)};this.getCurrentUrl=function(){return configCustomUrl||locationHrefAlias};this.setDocumentTitle=function(title){configTitle=title};this.setAPIUrl=function(apiUrl){configApiUrl=apiUrl};this.setDownloadClasses=function(downloadClasses){configDownloadClasses=isString(downloadClasses)?[downloadClasses]:downloadClasses};this.setLinkClasses=function(linkClasses){configLinkClasses=isString(linkClasses)?[linkClasses]:linkClasses};this.setCampaignNameKey=function(campaignNames){configCampaignNameParameters=isString(campaignNames)?[campaignNames]:campaignNames};this.setCampaignKeywordKey=function(campaignKeywords){configCampaignKeywordParameters=isString(campaignKeywords)?[campaignKeywords]:campaignKeywords};this.discardHashTag=function(enableFilter){configDiscardHashTag=enableFilter};this.setCookieNamePrefix=function(cookieNamePrefix){configCookieNamePrefix=cookieNamePrefix;customVariables=getCustomVariablesFromCookie()};this.setCookieDomain=function(domain){var domainFixed=domainFixup(domain);if(isPossibleToSetCookieOnDomain(domainFixed)){configCookieDomain=domainFixed;updateDomainHash()}};this.getCookieDomain=function(){return configCookieDomain};this.hasCookies=function(){return"1"===hasCookies()};this.setSessionCookie=function(cookieName,cookieValue,msToExpire){if(!cookieName){throw new Error("Missing cookie name")}if(!isDefined(msToExpire)){msToExpire=configSessionCookieTimeout}configCookiesToDelete.push(cookieName);setCookie(getCookieName(cookieName),cookieValue,msToExpire,configCookiePath,configCookieDomain)};this.getCookie=function(cookieName){var cookieValue=getCookie(getCookieName(cookieName));if(cookieValue===0){return null}return cookieValue};this.setCookiePath=function(path){configCookiePath=path;updateDomainHash()};this.getCookiePath=function(path){return configCookiePath};this.setVisitorCookieTimeout=function(timeout){configVisitorCookieTimeout=timeout*1000};this.setSessionCookieTimeout=function(timeout){configSessionCookieTimeout=timeout*1000};this.getSessionCookieTimeout=function(){return configSessionCookieTimeout};this.setReferralCookieTimeout=function(timeout){configReferralCookieTimeout=timeout*1000};this.setConversionAttributionFirstReferrer=function(enable){configConversionAttributionFirstReferrer=enable};this.disableCookies=function(){configCookiesDisabled=true;browserFeatures.cookie="0";if(configTrackerSiteId){deleteCookies()}};this.deleteCookies=function(){deleteCookies()};this.setDoNotTrack=function(enable){var dnt=navigatorAlias.doNotTrack||navigatorAlias.msDoNotTrack;configDoNotTrack=enable&&(dnt==="yes"||dnt==="1");if(configDoNotTrack){this.disableCookies()}};this.addListener=function(element,enable){addClickListener(element,enable)};this.enableLinkTracking=function(enable){linkTrackingEnabled=true;var self=this;trackCallback(function(){trackCallbackOnReady(function(){addClickListeners(enable,self)})})};this.maskFields=function(fieldNames){console.log("getMaskingInfo");console.log(configTrackerSiteId);console.log("getMaskingInfo")};this.getMaskingInfo=function(link,siteId){console.log("getMaskingInfo");console.log(account);console.log(this.getSiteId())};this.enableJSErrorTracking=function(){if(enableJSErrorTracking){return}enableJSErrorTracking=true;var onError=windowAlias.onerror;windowAlias.onerror=function(message,url,linenumber,column,error){trackCallback(function(){var category="JavaScript Errors";var action=url+":"+linenumber;if(column){action+=":"+column}logEvent(category,action,message)});if(onError){return onError(message,url,linenumber,column,error)}return false}};this.disablePerformanceTracking=function(){configPerformanceTrackingEnabled=false};this.setGenerationTimeMs=function(generationTime){configPerformanceGenerationTime=parseInt(generationTime,10)};this.enableHeartBeatTimer=function(heartBeatDelayInSeconds){heartBeatDelayInSeconds=Math.max(heartBeatDelayInSeconds,1);configHeartBeatDelay=(heartBeatDelayInSeconds||15)*1000;if(lastTrackerRequestTime!==null){setUpHeartBeat()}};this.disableHeartBeatTimer=function(){heartBeatDown();if(configHeartBeatDelay||heartBeatSetUp){if(windowAlias.removeEventListener){windowAlias.removeEventListener("focus",heartBeatOnFocus,true);windowAlias.removeEventListener("blur",heartBeatOnBlur,true)}else{if(windowAlias.detachEvent){windowAlias.detachEvent("onfocus",heartBeatOnFocus);windowAlias.detachEvent("onblur",heartBeatOnBlur)}}}configHeartBeatDelay=null;heartBeatSetUp=false};this.killFrame=function(){if(windowAlias.location!==windowAlias.top.location){windowAlias.top.location=windowAlias.location}};this.redirectFile=function(url){if(windowAlias.location.protocol==="file:"){windowAlias.location=url}};this.setCountPreRendered=function(enable){configCountPreRendered=enable};this.trackGoal=function(idGoal,customRevenue,customData){trackCallback(function(){logGoal(idGoal,customRevenue,customData)})};this.trackLink=function(sourceUrl,linkType,customData,callback){trackCallback(function(){logLink(sourceUrl,linkType,customData,callback)})};this.getNumTrackedPageViews=function(){return numTrackedPageviews};this.trackPageView=function(customTitle,customData,callback){trackedContentImpressions=[];if(isOverlaySession(configTrackerSiteId)){trackCallback(function(){injectOverlayScripts(configTrackerUrl,configApiUrl,configTrackerSiteId)})}else{trackCallback(function(){numTrackedPageviews++;logPageView(customTitle,customData,callback)})}};this.trackAllContentImpressions=function(){if(isOverlaySession(configTrackerSiteId)){return}trackCallback(function(){trackCallbackOnReady(function(){var contentNodes=content.findContentNodes();var requests=getContentImpressionsRequestsFromNodes(contentNodes);sendBulkRequest(requests,configTrackerPause)})})};this.trackVisibleContentImpressions=function(checkOnSroll,timeIntervalInMs){if(isOverlaySession(configTrackerSiteId)){return}if(!isDefined(checkOnSroll)){checkOnSroll=true}if(!isDefined(timeIntervalInMs)){timeIntervalInMs=750}enableTrackOnlyVisibleContent(checkOnSroll,timeIntervalInMs,this);trackCallback(function(){trackCallbackOnLoad(function(){var contentNodes=content.findContentNodes();var requests=getCurrentlyVisibleContentImpressionsRequestsIfNotTrackedYet(contentNodes);sendBulkRequest(requests,configTrackerPause)})})};this.trackContentImpression=function(contentName,contentPiece,contentTarget){if(isOverlaySession(configTrackerSiteId)){return}if(!contentName){return}contentPiece=contentPiece||"Unknown";trackCallback(function(){var request=buildContentImpressionRequest(contentName,contentPiece,contentTarget);sendRequest(request,configTrackerPause)})};this.trackContentImpressionsWithinNode=function(domNode){if(isOverlaySession(configTrackerSiteId)||!domNode){return}trackCallback(function(){if(isTrackOnlyVisibleContentEnabled){trackCallbackOnLoad(function(){var contentNodes=content.findContentNodesWithinNode(domNode);var requests=getCurrentlyVisibleContentImpressionsRequestsIfNotTrackedYet(contentNodes);sendBulkRequest(requests,configTrackerPause)})}else{trackCallbackOnReady(function(){var contentNodes=content.findContentNodesWithinNode(domNode);var requests=getContentImpressionsRequestsFromNodes(contentNodes);sendBulkRequest(requests,configTrackerPause)})}})};this.trackContentInteraction=function(contentInteraction,contentName,contentPiece,contentTarget){if(isOverlaySession(configTrackerSiteId)){return}if(!contentInteraction||!contentName){return}contentPiece=contentPiece||"Unknown";trackCallback(function(){var request=buildContentInteractionRequest(contentInteraction,contentName,contentPiece,contentTarget);sendRequest(request,configTrackerPause)})};this.trackContentInteractionNode=function(domNode,contentInteraction){if(isOverlaySession(configTrackerSiteId)||!domNode){return}trackCallback(function(){var request=buildContentInteractionRequestNode(domNode,contentInteraction);sendRequest(request,configTrackerPause)})};this.logAllContentBlocksOnPage=function(){var contentNodes=content.findContentNodes();var contents=content.collectContent(contentNodes);var consoleType=typeof console;if(consoleType!=="undefined"&&console&&console.log){console.log(contents)}};this.trackEvent=function(category,action,name,value,customData,callback){trackCallback(function(){logEvent(category,action,name,value,customData,callback)})};this.trackSiteSearch=function(keyword,category,resultsCount,customData){trackCallback(function(){logSiteSearch(keyword,category,resultsCount,customData)})};this.setEcommerceView=function(sku,name,category,price){if(!isDefined(category)||!category.length){category=""}else{if(category instanceof Array){category=JSON_CAPTURLY.stringify(category)}}customVariablesPage[5]=["_pkc",category];if(isDefined(price)&&String(price).length){customVariablesPage[2]=["_pkp",price]}if((!isDefined(sku)||!sku.length)&&(!isDefined(name)||!name.length)){return}if(isDefined(sku)&&sku.length){customVariablesPage[3]=["_pks",sku]}if(!isDefined(name)||!name.length){name=""}customVariablesPage[4]=["_pkn",name]};this.addEcommerceItem=function(sku,name,category,price,quantity){if(sku.length){ecommerceItems[sku]=[sku,name,category,price,quantity]}};this.trackEcommerceOrder=function(orderId,grandTotal,subTotal,tax,shipping,discount){logEcommerceOrder(orderId,grandTotal,subTotal,tax,shipping,discount)};this.trackEcommerceCartUpdate=function(grandTotal){logEcommerceCartUpdate(grandTotal)};this.trackRequest=function(request,customData,callback,pluginMethod){trackCallback(function(){var fullRequest=getRequest(request,customData,pluginMethod);sendRequest(fullRequest,configTrackerPause,callback)})};Capturly.trigger("TrackerSetup",[this])}function TrackerProxy(){return{push:apply}}function applyMethodsInOrder(paq,methodsToApply){var appliedMethods={};var index,iterator;for(index=0;index<methodsToApply.length;index++){var methodNameToApply=methodsToApply[index];appliedMethods[methodNameToApply]=1;for(iterator=0;iterator<paq.length;iterator++){if(paq[iterator]&&paq[iterator][0]){var methodName=paq[iterator][0];if(methodNameToApply===methodName){apply(paq[iterator]);delete paq[iterator];if(appliedMethods[methodName]>1){logConsoleError("The method "+methodName+' is registered more than once in "_paq" variable. Only the last call has an effect. Please have a look at the multiple Capturly trackers documentation: http://developer.capturly.org/guides/tracking-javascript-guide#multiple-capturly-trackers')}appliedMethods[methodName]++}}}}return paq}var applyFirst=["addTracker","disableCookies","setTrackerUrl","setAPIUrl","enableCrossDomainLinking","setCookiePath","setCookieDomain","setDomains","setUserId","setSiteId","enableLinkTracking","maskFields"];function createFirstTracker(capturlyUrl,siteId){var tracker=new Tracker(capturlyUrl,siteId);asyncTrackers.push(tracker);_paq=applyMethodsInOrder(_paq,applyFirst);for(iterator=0;iterator<_paq.length;iterator++){if(_paq[iterator]){apply(_paq[iterator])}}_paq=new TrackerProxy();return tracker}addEventListener(windowAlias,"beforeunload",beforeUnloadHandler,false);Date.prototype.getTimeAlias=Date.prototype.getTime;Capturly={initialized:false,JSON:JSON_CAPTURLY,DOM:{addEventListener:function(element,eventType,eventHandler,useCapture){var captureType=typeof useCapture;if(captureType==="undefined"){useCapture=false}addEventListener(element,eventType,eventHandler,useCapture)},onLoad:trackCallbackOnLoad,onReady:trackCallbackOnReady,isNodeVisible:isVisible,isOrWasNodeVisible:content.isNodeVisible},on:function(event,handler){if(!eventHandlers[event]){eventHandlers[event]=[]}eventHandlers[event].push(handler)},off:function(event,handler){if(!eventHandlers[event]){return}var i=0;for(i;i<eventHandlers[event].length;i++){if(eventHandlers[event][i]===handler){eventHandlers[event].splice(i,1)}}},trigger:function(event,extraParameters,context){if(!eventHandlers[event]){return}var i=0;for(i;i<eventHandlers[event].length;i++){eventHandlers[event][i].apply(context||windowAlias,extraParameters)}},addPlugin:function(pluginName,pluginObj){plugins[pluginName]=pluginObj},getTracker:function(capturlyUrl,siteId){if(!isDefined(siteId)){siteId=this.getAsyncTracker().getSiteId()}if(!isDefined(capturlyUrl)){capturlyUrl=this.getAsyncTracker().getTrackerUrl()}return new Tracker(capturlyUrl,siteId)},getAsyncTrackers:function(){return asyncTrackers},addTracker:function(capturlyUrl,siteId){if(!asyncTrackers.length){createFirstTracker(capturlyUrl,siteId)}else{asyncTrackers[0].addTracker(capturlyUrl,siteId)}},getAsyncTracker:function(capturlyUrl,siteId){var firstTracker;if(asyncTrackers&&asyncTrackers.length&&asyncTrackers[0]){firstTracker=asyncTrackers[0]}else{return createFirstTracker(capturlyUrl,siteId)}if(!siteId&&!capturlyUrl){return firstTracker}if((!isDefined(siteId)||null===siteId)&&firstTracker){siteId=firstTracker.getSiteId()}if((!isDefined(capturlyUrl)||null===capturlyUrl)&&firstTracker){capturlyUrl=firstTracker.getTrackerUrl()}var tracker,i=0;for(i;i<asyncTrackers.length;i++){tracker=asyncTrackers[i];if(tracker&&String(tracker.getSiteId())===String(siteId)&&tracker.getTrackerUrl()===capturlyUrl){return tracker}}},retryMissedPluginCalls:function(){var missedCalls=missedPluginTrackerCalls;missedPluginTrackerCalls=[];var i=0;for(i;i<missedCalls.length;i++){apply(missedCalls[i])}},getFieldNamesToMask:function(url,account,callback){try{var xhr=windowAlias.XMLHttpRequest?new windowAlias.XMLHttpRequest():windowAlias.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;xhr.open("POST",url+"/maskinfo",true);xhr.withCredentials=true;xhr.onreadystatechange=function(){if(this.readyState===4&&this.status==200){callback(xhr.responseText)}};xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send("acc="+account)}catch(e){}}};if(typeof define==="function"&&define.amd){define("capturly",[],function(){return Capturly})}return Capturly}())}/*!! pluginTrackerHook*/
(function(){function b(){if("object"!==typeof _paq){return false}var c=typeof _paq.length;if("undefined"===c){return false}return!!_paq.length}if(window&&"object"===typeof window.capturlyPluginAsyncInit&&window.capturlyPluginAsyncInit.length){var a=0;for(a;a<window.capturlyPluginAsyncInit.length;a++){if(typeof window.capturlyPluginAsyncInit[a]==="function"){window.capturlyPluginAsyncInit[a]()}}}if(window&&window.capturlyAsyncInit){window.capturlyAsyncInit()}if(!window.Capturly.getAsyncTrackers().length){if(b()){window.Capturly.addTracker()}else{_paq={push:function(c){var d=typeof console;if(d!=="undefined"&&console&&console.error){console.error("_paq.push() was used but Capturly tracker was not initialized before the capturly.js file was loaded. Make sure to configure the tracker via _paq.push before loading capturly.js. Alternatively, you can create a tracker via Capturly.addTracker() manually and then use _paq.push but it may not fully work as tracker methods may not be executed in the correct order.",c)}}}}}window.Capturly.trigger("CapturlyInitialized",[]);window.Capturly.initialized=true}());(function(){var a=(typeof AnalyticsTracker);if(a==="undefined"){AnalyticsTracker=window.Capturly}}());if(typeof capturly_log!=="function"){capturly_log=function(c,f,a,g){function b(h){try{if(window["capturly_"+h]){return window["capturly_"+h]}}catch(j){}return}var d,e=window.Capturly.getTracker(a,f);e.setDocumentTitle(c);e.setCustomData(g);d=b("tracker_pause");if(d){e.setLinkTrackingTimer(d)}d=b("download_extensions");if(d){e.setDownloadExtensions(d)}d=b("hosts_alias");if(d){e.setDomains(d)}d=b("ignore_classes");if(d){e.setIgnoreClasses(d)}e.trackPageView();if(b("install_tracker")){capturly_track=function(k,l,j,h){e.setSiteId(l);e.setTrackerUrl(j);e.trackLink(k,h)};e.enableLinkTracking()}}}/*!@license-end*/;_paq.push([function(){cpid=this.getVisitorId()}]);(function(B){var X,N,d,I,y,J,G,f,g,o,m,W,ae,E,V,q,O,R,h,L,P,aa,Z,r,p,af,ad,u,K,e,M,s,H,c,S,z,Y,A,F,C,ac,U,Q,n,x,w=function(v,l){for(var k in l){if(j.call(l,k)){v[k]=l[k]}}function t(){this.constructor=v}t.prototype=l.prototype;v.prototype=new t();v.__super__=l.prototype;return v},j={}.hasOwnProperty,b=[],D=[],a=true,T=["SSN","CREDITCARD","CC","CCNUM","CCNAME","CCNUMBER","CCEXPIRY","CCEXP","CCEXPMONTH","CCEXPYEAR","CCCVC","CCCVV","CCTYPE","CVC","CVV"];var ab=2;f=window.MutationObserver||window.WebKitMutationObserver;W=(function(){function k(){this.nodes=[];this.values=[]}k.prototype.isIndex=function(l){return+l===l>>>0};k.prototype.nodeId=function(l){var t;t=l[k.ID_PROP]||(l.getAttribute?parseInt(l.getAttribute(k.ID_PROP),10):null);if(!t){t=l[k.ID_PROP]=k.nextId_++;if(l.setAttribute){l.setAttribute(k.ID_PROP,t)}}return t};k.prototype.set=function(l,t){var v;v=this.nodeId(l);this.nodes[v]=l;return this.values[v]=t};k.prototype.get=function(l){var t;t=this.nodeId(l);return this.values[t]};k.prototype.has=function(l){return this.nodeId(l)in this.nodes};k.prototype["delete"]=function(l){var t;t=this.nodeId(l);delete this.nodes[t];this.values[t]=void 0};k.prototype.keys=function(){var t,l;l=[];for(t in this.nodes){if(!this.isIndex(t)){continue}l.push(this.nodes[t])}return l};k.ID_PROP="data-trid";k.nextId_=1;return k})();G={STAYED_OUT:0,ENTERED:1,STAYED_IN:2,REPARENTED:3,REORDERED:4,EXITED:5};m=(function(){function k(l){this.node=l;this.childList=false;this.attributes=false;this.characterData=false;this.oldParentNode=null;this.added=false;this.attributeOldValues=null;this.characterDataOldValue=null;this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}k.prototype.getAttributeOldValue=function(l){if(!this.attributeOldValues){return void 0}if(this.isCaseInsensitive){l=l.toLowerCase()}return this.attributeOldValues[l]};k.prototype.getAttributeNamesMutated=function(){var l,t;t=[];if(!this.attributeOldValues){return t}for(l in this.attributeOldValues){t.push(l)}return t};k.prototype.attributeMutated=function(t,l){this.attributes=true;this.attributeOldValues=this.attributeOldValues||{};if(t in this.attributeOldValues){return}if(/^(title|tabindex|data-|aria-)/i.test(t)){return}this.attributeOldValues[t]=l};k.prototype.characterDataMutated=function(l){if(this.characterData){return}this.characterData=true;this.characterDataOldValue=l};k.prototype.removedFromParent=function(l){this.childList=true;if(this.added||this.oldParentNode){this.added=false}else{this.oldParentNode=l}};k.prototype.insertedIntoParent=function(){this.childList=true;this.added=true;var l=this.node.getElementsByTagName("*");for(Z=0,r=l.length;Z<r;Z++){el=l[Z];if(!el.getAttribute(W.ID_PROP)){el.setAttribute(W.ID_PROP,W.nextId_++)}}};k.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode){return this.oldParentNode}if(this.added){return null}}return this.node.parentNode};return k})();N=(function(){function k(){this.added=new W;this.removed=new W;this.maybeMoved=new W;this.oldPrevious=new W;this.moved=void 0}return k})();O=(function(l){w(k,l);function k(ag,ah){var aq,al,ao,an,am,ak,aj,v,ai,t,ap;k.__super__.constructor.call(this);this.rootNode=ag;this.reachableCache=void 0;this.wasReachableCache=void 0;this.anyParentsChanged=false;this.anyAttributesChanged=false;this.anyCharacterDataChanged=false;for(al=0,ao=ah.length;al<ao;al++){aj=ah[al];switch(aj.type){case"childList":t=aj.removedNodes;for(ak=0,an=t.length;ak<an;ak++){ai=t[ak];if(ai.nodeType===1){this.anyParentsChanged=true;this.getChange(ai).removedFromParent(aj.target)}else{this.anyCharacterDataChanged=true;aq=this.getChange(aj.target);aq.characterDataMutated(ai)}}ap=aj.addedNodes;for(v=0,am=ap.length;v<am;v++){ai=ap[v];if(ai.nodeType===1){this.anyParentsChanged=true;this.getChange(ai).insertedIntoParent()}else{this.anyCharacterDataChanged=true;aq=this.getChange(aj.target);aq.characterDataMutated(ai)}}break;case"attributes":this.anyAttributesChanged=true;aq=this.getChange(aj.target);aq.attributeMutated(aj.attributeName,aj.oldValue);break;case"characterData":this.anyCharacterDataChanged=true;aq=this.getChange(aj.target.parentNode);aq.characterDataMutated(aj.oldValue)}}}k.prototype.getChange=function(t){var v;v=this.get(t);if(!v){v=new m(t);this.set(t,v)}return v};k.prototype.getOldParent=function(t){var v;v=this.get(t);if(v){return v.getOldParent()}else{return t.parentNode}};k.prototype.getIsReachable=function(t){var v;if(t===this.rootNode){return true}if(!t){return false}this.reachableCache=this.reachableCache||new W;v=this.reachableCache.get(t);if(v===void 0){v=this.getIsReachable(t.parentNode);this.reachableCache.set(t,v)}return v};k.prototype.getWasReachable=function(t){var v;if(t===this.rootNode){return true}if(!t){return false}this.wasReachableCache=this.wasReachableCache||new W;v=this.wasReachableCache.get(t);if(v===void 0){v=this.getWasReachable(this.getOldParent(t));this.wasReachableCache.set(t,v)}return v};k.prototype.reachabilityChange=function(t){if(this.getIsReachable(t)){if(this.getWasReachable(t)){return G.STAYED_IN}else{return G.ENTERED}}if(this.getWasReachable(t)){return G.EXITED}else{return G.STAYED_OUT}};return k})(W);g=(function(){function k(t,l){this.rootNode=t;this.mutations=l;this.calcReordered=true;this.treeChanges=new O(t,l);this.entered=[];this.exited=[];this.stayedIn=new W;this.visited=new W;this.childListChangeMap=void 0;this.matchCache=void 0;this.processMutations()}k.prototype.processMutations=function(){var v,t,ag,ai,ah;if(!this.treeChanges.anyParentsChanged&&!this.treeChanges.anyAttributesChanged){return}v=this.treeChanges.keys();ah=[];for(t=0,ag=v.length;t<ag;t++){ai=v[t];ah.push(this.visitNode(ai,void 0))}return ah};k.prototype.visitNode=function(ag,t){var ah,l,v;if(this.visited.has(ag)){return}this.visited.set(ag,true);ah=this.treeChanges.get(ag);v=t;if((ah&&ah.childList)||(v==null)){v=this.treeChanges.reachabilityChange(ag)}if(v===G.STAYED_OUT){return}if(v===G.ENTERED){return this.entered.push(ag)}else{if(v===G.EXITED){return this.exited.push(ag)}else{if(v===G.STAYED_IN){l=G.STAYED_IN;if(ah&&ah.childList){if(ah.oldParentNode!==ag.parentNode){l=G.REPARENTED}else{if(this.calcReordered){l=G.REORDERED}}}return this.stayedIn.set(ag,l)}}}};k.prototype.getChanged=function(ap){var aj,am,al,ak,ai,t,ag,ah,v,ao,an,aq;v=this.entered;for(aj=0,am=v.length;aj<am;aj++){ah=v[aj];ap.added.push(ah)}aq=this.stayedIn.keys();for(ai=0,al=aq.length;ai<al;ai++){ah=aq[ai];if(ap.reparented||ap.reordered){t=this.stayedIn.get(ah);if(ap.reparented&&t===G.REPARENTED){ap.reparented.push(ah)}else{if(ap.reordered&&t===G.REORDERED){ap.reordered.push(ah)}}}}ao=this.exited;an=[];for(ag=0,ak=ao.length;ag<ak;ag++){ah=ao[ag];an.push(ap.removed.push(ah))}return an};k.prototype.getOldParentNode=function(t){var v,l;v=this.treeChanges.get(t);if(v&&v.childList){if(v.oldParentNode){return v.oldParentNode}else{return null}}l=this.treeChanges.reachabilityChange(t);if(l===G.STAYED_OUT||l===G.ENTERED){throw Error("getOldParentNode requested on invalid node.")}return t.parentNode};k.prototype.getOldPreviousSibling=function(v){var ag,t,l;l=v.parentNode;t=this.treeChanges.get(v);if(t&&t.oldParentNode){l=t.oldParentNode}ag=this.childListChangeMap.get(l);if(!ag){throw Error("getOldPreviousSibling requested on invalid node.")}return ag.oldPrevious.get(v)};k.prototype.getOldAttribute=function(t,l){var ag,v;ag=this.treeChanges.get(t);if(!ag||!ag.attributes){throw Error("getOldAttribute requested on invalid node.")}v=ag.getAttributeOldValue(l);if(v===void 0){throw Error("getOldAttribute requested for unchanged attribute name.")}return v};k.prototype.attributeChangedNodes=function(){var an,ao,ag,am,aj,al,ak,ai,ah,v,t,ap;if(!this.treeChanges.anyAttributesChanged){return{}}ap={};v=this.treeChanges.keys();for(aj=0,al=v.length;aj<al;aj++){ah=v[aj];ao=this.treeChanges.get(ah);if(!ao.attributes){continue}if(G.STAYED_IN!==this.treeChanges.reachabilityChange(ah)){continue}am=ah;ag=ao.getAttributeNamesMutated();for(ai=0,ak=ag.length;ai<ak;ai++){an=ag[ai];t=ao.getAttributeOldValue(an);if(t===am.getAttribute(an)){continue}ap[an]=ap[an]||[];ap[an].push(am)}}return ap};k.prototype.getOldCharacterData=function(l){var t;t=this.treeChanges.get(l);if(!t||!t.characterData){throw Error("getOldCharacterData requested on invalid node.")}return t.characterDataOldValue};k.prototype.getCharacterDataChanged=function(){var aj,v,ah,ag,t,ai;if(!this.treeChanges.anyCharacterDataChanged){return[]}ag=this.treeChanges.keys();t=[];for(v=0,ah=ag.length;v<ah;v++){ai=ag[v];if(G.STAYED_IN!==this.treeChanges.reachabilityChange(ai)){continue}aj=this.treeChanges.get(ai);if(!aj.characterData||ai.textContent===aj.characterDataOldValue){continue}t.push(ai)}return t};k.prototype.getChildlistChange=function(l){var t;t=this.childListChangeMap.get(l);if(!t){t=new N();this.childListChangeMap.set(l,t)}return t};k.prototype.processChildlistChanges=function(){var ao,aj,al,ak,ai,ah,ag,ap,t,v,an,am;if(this.childListChangeMap){return}t=function(ar,aq,l){if(!aq||ar.oldPrevious.has(aq)||ar.added.has(aq)||ar.maybeMoved.has(aq)){return}if(l&&(ar.added.has(l)||ar.maybeMoved.has(l))){return}return ar.oldPrevious.set(aq,l)};this.childListChangeMap=new W;v=this.mutations;am=[];for(aj=0,al=v.length;aj<al;aj++){ah=v[aj];if(ah.type!=="childList"){continue}if(this.treeChanges.reachabilityChange(ah.target)!==G.STAYED_IN){continue}ao=this.getChildlistChange(ah.target);ap=ah.previousSibling;an=ah.removedNodes;for(ai=0,ak=an.length;ai<ak;ai++){ag=an[ai];t(ao,ag,ap);if(ao.added.has(ag)){ao.added["delete"](ag)}else{ao.removed.set(ag,true);ao.maybeMoved["delete"](ag)}ap=ag}t(ao,ah.nextSibling,ap);am.push((function(){var aq,at,l,ar;l=ah.addedNodes;ar=[];for(at=0,aq=l.length;at<aq;at++){ag=l[at];if(ao.removed.has(ag)){ao.removed["delete"](ag);ar.push(ao.maybeMoved.set(ag,true))}else{ar.push(ao.added.set(ag,true))}}return ar})())}return am};k.prototype.wasReordered=function(t){var ai,al,am,ah,ak,aj,v,l,ag;if(!this.treeChanges.anyParentsChanged){return false}this.processChildlistChanges();v=t.parentNode;ak=this.treeChanges.get(t);if(ak&&ak.oldParentNode){v=ak.oldParentNode}ai=this.childListChangeMap.get(v);if(!ai){return false}if(ai.moved){return ai.moved.get(t)}ai.moved=new W;l=new W;ah=function(an){var ao;if(!an){return false}if(!ai.maybeMoved.has(an)){return false}ao=ai.moved.get(an);if(ao!==void 0){return ao}if(l.has(an)){ao=true}else{l.set(an,true);ao=am(an)!==al(an)}if(l.has(an)){l["delete"](an);ai.moved.set(an,ao)}else{ao=ai.moved.get(an)}return ao};aj=new W;al=function(ao){var an;an=aj.get(ao);if(an!==void 0){return an}an=ai.oldPrevious.get(ao);while(an&&(ai.removed.has(an)||ah(an))){an=al(an)}if(an===void 0){an=ao.previousSibling}aj.set(ao,an);return an};ag=new W;am=function(ao){var an;if(ag.has(ao)){return ag.get(ao)}an=ao.previousSibling;while(an&&(ai.added.has(an)||ah(an))){an=an.previousSibling}ag.set(ao,an);return an};ai.maybeMoved.keys().forEach(ah);return ai.moved.getnode};return k})();V=(function(){function k(l){this.projection=l;this.added=[];this.removed=[];this.reparented=[];this.reordered=[];l.getChanged(this);this.attributeChanged=l.attributeChangedNodes();this.characterDataChanged=l.getCharacterDataChanged();if(this.reordered){this.getOldPreviousSibling=l.getOldPreviousSibling.bind(l)}}k.prototype.getOldParentNode=function(l){return this.projection.getOldParentNode(l)};k.prototype.getOldAttribute=function(t,l){return this.projection.getOldAttribute(t,l)};k.prototype.getOldCharacterData=function(l){return this.projection.getOldCharacterData(l)};k.prototype.getOldPreviousSibling=function(l){return this.projection.getOldPreviousSibling(l)};return k})();o=(function(){function k(ai){var ah,v,t,ag;this.observerOptions={childList:true,subtree:true,attributes:true,attributeOldValue:true,characterData:true,characterDataOldValue:true};this.root=document.body;v=document.getElementsByTagName("*");for(t=0,ag=v.length;t<ag;t++){ah=v[t];if(!ah.getAttribute(W.ID_PROP)){ah.setAttribute(W.ID_PROP,W.nextId_++)}}this.observer=new f((function(l){return function(aj){return l.observerCallback(aj)}})(this));this.observer.observe(this.root,this.observerOptions);this.mutations=[];setInterval((function(l){return function(){var aj;aj=l.createSummary(l.mutations);if(l.changesToReport(aj)){s(aj)}return l.mutations=[]}})(this),100)}k.prototype.createSummary=function(t){var l;if(!t||!t.length){return[]}l=new g(this.root,t);return new V(l)};k.prototype.changesToReport=function(l){var v,t,ah,ag;ag=["added","removed","reordered","reparented","characterDataChanged"];ah=ag.some(function(ai){return l[ai]&&l[ai].length});if(ah){return true}if(l.attributeChanged){v=Object.keys(l.attributeChanged);t=v.some(function(ai){return!!l.attributeChanged[ai].length});if(t){return true}}return false};k.prototype.observerCallback=function(l){return this.mutations=this.mutations.concat(l)};return k})();s=function(aT){var ax,aA,aU,az,aS,aE,av,aj,aH,aD,aC,ay,aR,am,an,al,ak,ai,ah,ag,v,aQ,aP,aM,k,aO,ao,aB,aL,aK,aI,aw,au,at,ar,aq,ap,aN,aV,aF,t,aG,aJ;aA=[];aS=0;aI=aT.removed;for(aR=0,an=aI.length;aR<an;aR++){aU=aI[aR];aA.push("r>"+(aU.getAttribute("data-trid")))}aw=["added","reparented"];for(aQ=0,al=aw.length;aQ<al;aQ++){aN=aw[aQ];aC=aN==="added";aM=[];au=aT[aN];for(aP=0,ak=au.length;aP<ak;aP++){aU=au[aP];aM.push(aU.getAttribute("data-trid"))}aH=[];at=aT[aN];for(aO=0,ai=at.length;aO<ai;aO++){aU=at[aO];aE=aU.getAttribute("data-trid");if(~aH.indexOf(aE)){continue}ao=aU.parentNode;if(ao&&~aH.indexOf(ao.getAttribute("data-trid"))){aH.push(aE);continue}av=[aE];aj=[aC?aU.outerHTML:aE];aB=k=null;aV=aU;while(aB=aV.previousSibling){if(aB.nodeType!==1){break}aF=aB.getAttribute("data-trid");if(!~aM.indexOf(aF)){break}av.unshift(aF);aj.unshift(aC?aB.outerHTML:aF);aV=aB}aV=aU;while(k=aV.nextSibling){if(k.nodeType!==1){break}aF=k.getAttribute("data-trid");if(!~aM.indexOf(aF)){break}av.push(aF);aj.push(aC?k.outerHTML:aF);aV=k}aH=aH.concat(av);if(aC){ay="a";aJ=X.encode(aj.join(""))}else{ay="rp";aJ=aj.join("-")}if(aB&&aB.nodeType===1){aA.push(ay+">"+aJ+">a>"+(aB.getAttribute("data-trid")))}else{if(k&&k.nodeType===1){aA.push(ay+">"+aJ+">b>"+(k.getAttribute("data-trid")))}else{az=aU.parentNode.firstChild;am=aU.parentNode.lastChild;t=aU.parentNode.getAttribute("data-trid");if(az&&az.nodeType===1&&~av.indexOf(az.getAttribute("data-trid"))){aA.push(ay+">"+aJ+">pr>"+t)}else{if(am&&am.nodeType===1&&~av.indexOf(am.getAttribute("data-trid"))){aA.push(ay+">"+aJ+">ap>"+t)}else{aA.push(ay+">"+(X.encode(aU.parentNode.innerHTML))+">h>"+t)}}}}}}ar=aT.reordered;for(aL=0,ah=ar.length;aL<ah;aL++){aU=ar[aL];aD=Array.prototype.indexOf.call(aU.parentNode.childNodes,aU);aA.push("ro>"+(aU.getAttribute("data-trid"))+">"+aD)}for(ax in aT.attributeChanged){aq=aT.attributeChanged[ax];for(aK=0,ag=aq.length;aK<ag;aK++){aU=aq[aK];if(/^data-trid/i.test(ax)){aA.push("at>"+X.encode((I.path(aU)))+">"+ax+">"+(X.encode(aU.getAttribute(ax)||"")))}else{aA.push("at>"+(aU.getAttribute("data-trid"))+">"+ax+">"+(X.encode(aU.getAttribute(ax)||"")))}}}ap=aT.characterDataChanged;for(aG=0,v=ap.length;aG<v;aG++){aU=ap[aG];aA.push("h>"+(aU.getAttribute("data-trid"))+">"+(X.encode(aU.innerHTML)))}return M.collect+="muo,"+(ac())+","+(aA.join("|"))+";"};if(/Googlebot\//i.test(navigator.userAgent)){return}(function(k){return window.onerror=function(ah,v,l,t,ag){if(v&&/capturly\.com\/(.+)track(-[a-f0-9]+)?\.js$/.test(v)){console.error("--- Capturly error ---\n"+ah+"\n"+(ag!=null?ag.stack:void 0));return true}else{return k!=null?k.apply(this,arguments):void 0}}})(window.onerror);X={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(am){var al,ak,aj,ai,ah,v,t,l,k,ag;al="";k=0;am=X._utf8_encode(am);ag=am.length;while(k<ag){ak=am.charCodeAt(k++);aj=am.charCodeAt(k++);ai=am.charCodeAt(k++);ah=ak>>2;v=(ak&3)<<4|aj>>4;t=(aj&15)<<2|ai>>6;l=ai&63;if(isNaN(aj)){t=l=64}else{isNaN(ai)&&(l=64)}al+=X._keyStr.charAt(ah)+X._keyStr.charAt(v)+X._keyStr.charAt(t)+X._keyStr.charAt(l)}return al.replace(/\+/g,"_")},_utf8_encode:function(k){k=k.replace(/\r\n/g,"\n");return unescape(encodeURIComponent(k))}};I={index:function(ah,t){var ai,ag,k,v;for(ag=k=0,v=t.length;k<v;ag=++k){ai=t[ag];if(ai===ah){return ag}}},similar_siblings:function(t,l){var k;k=[];while(t=t.nextSibling){if(t.nodeType===1&&t.nodeName.toLowerCase()===l){k.push(t)}}return k},path:function(ag,v){var l,ah,k,t,ai;if(v==null){v=true}while(ag){l=ag.nodeName;if(!l||l==="#document"||l==="HTML"){break}l=l.toLowerCase();if(ag.id&&v){return l+"#"+ag.id+(ah?">"+ah:"")}t=ag.parentNode;k=t.firstChild;ai=I.similar_siblings(k,l);if(ai.length>0){if(l===k.nodeName.toLowerCase()){ai.unshift(k)}if(ai.length>1){l+="["+I.index(ag,ai)+"]"}}ah=l+(ah?">"+ah:"");ag=t}return ah},html:function(){var k,l;k=function(){var t;if(!document.doctype){return""}t=document.doctype;return"<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"};l=function(ai){var t,ag,v,ah;ag=ai.attributes;l="<"+(ai.nodeName.toLowerCase());for(v=0,ah=ag.length;v<ah;v++){t=ag[v];l+=" "+t.name+'="'+t.value+'"'}return l+=">"};return k()+"\n"+l(document.documentElement)+document.documentElement.innerHTML+"</html>"},offset:function(k){var t,l;t={x:0,y:0,w:0,h:0};if(typeof k.getBoundingClientRect==="undefined"){return t}l=k.getBoundingClientRect();return t={x:l.left+M.curr_scroll.x-(document.documentElement.clientLeft||0),y:l.top+M.curr_scroll.y-(document.documentElement.clientTop||0),w:l.right-l.left,h:l.bottom-l.top}},viewport:function(){var k;k=document.documentElement||document.body;return M.curr_browser={x:k.clientWidth,y:k.clientHeight}},scroll_position:function(){if(window.pageYOffset!=null){return M.curr_scroll={x:window.pageXOffset,y:window.pageYOffset}}else{return M.curr_scroll={x:Math.max(document.body.scrollLeft,document.documentElement.scrollLeft),y:Math.max(document.body.scrollTop,document.documentElement.scrollTop)}}},has_class:function(k,l){if(k.nodeType===1&&(" "+k.className+" ").replace(/[\t\r\n]/g," ").indexOf(l)>=0){return true}else{return false}},closestId:function(k,t){if(t){t=t.toUpperCase();while(k){var l=k.getAttribute("id");if(l&&l.toUpperCase()===t){return k}k=k.parentElement}}return null}};K=[];F=[];h=function(){var t,ai,ah,k,aj,ag;for(t=0,ai=K.length;t<ai;t++){ag=K[t];if(ag.e.addEventListener){ag.e.removeEventListener(ag.t,ag.f,true)}else{if(ag.e.attachEvent){ag.e.detachEvent("on"+ag.t,ag.f)}}}for(k=0,ah=F.length;k<ah;k++){aj=F[k];clearInterval(aj)}return E.send_data(true)};y={listener:function(t,l){var ag,k,v;k=function(ai){var aj,ah;ah=ai||window.event;if(!ah.target){ah.target=ai.srcElement||document}if(ah.target.nodeType===3){ah.target=ah.target.parentNode}if(t==="mouseover"||t==="mouseout"){aj=ah.relatedTarget;while(aj&&aj!==this){aj=aj.parentNode}if(aj===this){return}}ah.orig_type=t;return l.call(this,ah)};if(this.addEventListener){ag={mouseenter:"mouseover",mouseleave:"mouseout"};v=ag[t]||t;this.addEventListener(v,k,true);return K.push({e:this,t:v,f:k})}else{if(this.attachEvent){ag={focus:"focusin",blur:"focusout"};v=ag[t]||t;return this.attachEvent("on"+v,k)}}}};q={performance:window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance,_start:function(){var l,k;if((l=this.performance)!=null?(k=l.timing)!=null?k.navigationStart:void 0:void 0){return this.performance.timing.navigationStart}},_first_byte:function(){return this.performance.timing.responseStart-this.start},_last_byte:function(){return this.performance.timing.domContentLoadedEventStart-this.start},_onload:function(){return this.performance.timing.loadEventEnd-this.start},get_data:function(){if(this.start=this._start()){return(this._first_byte())+","+(this._last_byte())+","+(this._onload())}else{return""}}};p=function(){return new Date().getTime()};ac=function(){return(""+(p())).slice(-9)};M={url:"https://collector.capturly.com/collect",start_time:ac(),last_page_view:p(),returning_user:false,session_id:"",page_id:"",collect:"",html_sent:false,page_loaded:false,can_send_html:false,last_mouse:{x:0,y:0},curr_mouse:{x:0,y:0},last_scroll:{x:0,y:0},curr_scroll:{x:0,y:0},last_browser:{x:0,y:0},curr_browser:{x:0,y:0},custom:[],reset_start_time:false,muo:window.MutationObserver||window.WebKitMutationObserver,muo_inited:false,second_load:false,last_non_muo:p(),scroll_elements:{}};e=null;R=function(){var k;if(M.can_send_html){return}M.can_send_html=true;k=d.get("_tr_sess").split("|"),M.session_id=k[0],M.last_page_view=k[1];M.last_page_view=parseInt(M.last_page_view,10)||p();M.returning_user=!!d.get("_tr_user");d.set("_tr_user","1",30);if(M.page_id===""){window.__tr_page_id=M.page_id=ae().page_id()}if(n()){H()}if(M.page_loaded){return ad()}};c=function(){return!!d.get("_tr_stop_recording")};H=function(){d.set("_tr_stop_recording","0",-1);d.set("_tr_form","",-1);M.reset_start_time=true;M.start_time=ac();M.collect="";return M.html_sent=false};n=function(){return M.session_id===""||p()-M.last_page_view>1800000};x=function(){var k=document.getElementById("capturlyDontRecordThisPage");if(k||k!=null){return true}return false};S=trq.q;for(Z=0,r=S.length;Z<r;Z++){z=S[Z],U=z[0],aa=z[1],Q=z[2];switch(U){case"account":M.account=aa;break;case"demo":M.url="//backend.capturly.test/collect";break;case"staging":M.url="//collector.wwwtest.capturly.com/collect";break;case"set":if(aa!=null){M.custom.push({el:aa,ea:Q,ev:z[3],et:Date.now()})}}}window.Capturly.getFieldNamesToMask(M.url,M.account,function(l){if(typeof l==="string"&&l!==""){var k=JSON.parse(l)}if(typeof k==="object"){if(typeof k.default_masking==="boolean"){a=k.default_masking}if(typeof k.fields_to_mask==="string"){b=k.fields_to_mask.toUpperCase().split(",");if(b.length===1&&b[0]===""){b=[]}}if(typeof k.fields_to_tag==="string"){D=k.fields_to_tag.toUpperCase().split(",");if(D.length===1&&D[0]===""){D=[]}}}});trq.q=[];trq.q.push=function(k){var aj,ah,ag,ai;aj=k[0],ah=k[1],ag=k[2],ai=k[3];if(aj==="set"&&ah!=null){M.custom.push({el:ah,ea:ag,ev:ai,et:Date.now()});_paq.push(["trackEvent",ai,ag,ah])}};L=function(l,k){return l.x===k.x&&l.y===k.y};E={getid:function(l,k){return E.request(M.url+"/getid",l,function(t){return k(t)})},send_short:function(t,k){var l;l=new Image;l.onload=function(){if(k){return k()}};return l.src=M.url+"?"+t},request:function(l,t,k){if(t.length>0){t="jsv="+trackjs_version+"&"+t}var ag,v;v=window.XDomainRequest;if(v){if(window.location.protocol==="http:"){l=l.replace(/^https:/,"http:")}ag=new v;ag.open("POST",l);ag.onprogress=function(){};ag.onerror=function(){return d.set("_tr_stop_recording","1")};ag.onload=function(){if(k){k(ag.responseText)}return ag=null}}else{if(v=window.XMLHttpRequest){v=new v;if("withCredentials"in v){ag=v;ag.open("POST",l,true);ag.withCredentials=true;ag.setRequestHeader("Content-Type","application/x-www-form-urlencoded");ag.onreadystatechange=function(){if(ag.readyState===4){if(ag.status===420){d.set("_tr_stop_recording","1")}if(k){k(ag.responseText)}return ag=null}}}}}if(ag){return ag.send(t)}},send_long:function(l,k){if(c()){return}return E.request(M.url,l,k)},send_data:function(k){var aj,ak,ai,ah,v,l,t,ag,an,am,al;if(c()){return}if(!M.html_sent){return}if(!M.account){return}if((ah=M.collect.length)===0){return}if(x()){M.collect="";return}ak="";if(M.custom.length){ag=M.custom;for(l=0,v=ag.length;l<v;l++){aj=ag[l];if(l==v-1){ak+=JSON.stringify(aj)}else{ak+=JSON.stringify(aj)+";"}}ak="&cus="+(X.encode(ak))}t="s="+M.session_id+"&pid="+M.page_id+"&acc="+M.account+"&doc="+(encodeURIComponent(window.location.href))+"&ver="+ab+ak+"&cpid="+B;if(!k){am=false;if(n()){H();ad();return}else{if(p()-M.last_page_view>120000){am=true}}if(ah<=2000){if(ah<1000&&!am){return}E.send_short(t+"&c="+M.collect)}else{E.send_long(t+"&c="+M.collect)}M.last_page_view=p();d.set("_tr_sess",M.session_id+"|"+M.last_page_view);M.collect="";return M.custom=[]}else{if(n()){return}al=false;E.send_long(t+"&c="+M.collect,function(){return al=true});M.collect="";M.custom=[];an=ai=p();while(ai-an<300){if(al){return}ai=p()}}},ping:function(){if(M.collect.length===0){return}M.collect="";if(n()){d.set("_tr_stop_recording","0",-1);clearInterval(e);H();ad();return}M.last_page_view=p();return E.request(M.url+"/ping","s="+M.session_id+"&acc="+M.account+"&ver="+ab,function(){})}};ae=function(){var k;k=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return{page_id:function(){return k()+k()+k()+k()+k()}}};d={set:function(l,ag,k){var v,t;v=new Date;v.setDate(v.getDate()+k);t=k!=null?"; expires="+(v.toUTCString()):"";return document.cookie=l+"="+ag+t+"; path=/;"},get:function(t){var k,l,v;l=document.cookie;k=l.indexOf(t+"=");if(k!==-1){k=k+t.length+1;v=l.indexOf(";",k);if(v===-1){v=l.length}return unescape(l.substring(k,v))}else{return""}}};J={events:{},forms:null,focused_input:null,"do":null,generate_hash:function(t){var v,l,k;k=J.get_inputs(t);v=[];for(aa in k){l=k[aa];v.push(l.name)}return v.join("|")},init:function(){if(J.forms==null){J.forms=document.getElementsByTagName("form")}return J.setup_events()},get_inputs:function(k){var an,aj,ai,ah,v,ag,t,l,ak,al,am;ak={};aj=k.getElementsByTagName("input");for(ag=0,ai=aj.length;ag<ai;ag++){an=aj[ag];if(~"button,hidden,reset,submit".indexOf(an.type)){continue}if(J.need_to_mask(an)===true){ak[an.getAttribute("data-trid")]=J.maskInput(an)}else{ak[an.getAttribute("data-trid")]=an}}am=k.getElementsByTagName("textarea");for(t=0,ah=am.length;t<ah;t++){an=am[t];if(J.need_to_mask(an)===true){ak[an.getAttribute("data-trid")]=J.maskInput(an)}else{ak[an.getAttribute("data-trid")]=an}}al=k.getElementsByTagName("select");for(l=0,v=al.length;l<v;l++){an=al[l];ak[an.getAttribute("data-trid")]=an}return ak},input_name:function(k){if(k.type==="radio"){if(!k.name){return}return(k.name+"|"+k.value).replace(/^\s+|\s+$/g,"")}else{return k.name.replace(/^\s+|\s+$/g,"")}},setup_events:function(){var ag,t,k,l,v;l=J.forms;v=[];for(k=0,t=l.length;k<t;k++){ag=l[k];v.push(y.listener.call(ag,"submit",function(ah){return J.collect(ah.target,true)}))}return v},collect:function(l,ai){var k,ah,aj,ak,v,ag,t;if(ai==null){ai=false}ah=J.events[l.getAttribute("data-trid")];if(!ah.changed){return}if(ah!=null?ah.is:void 0){ah.it+=p()-ah.is;delete ah.is;t=[];ag=J.get_inputs(ah.form);for(aa in ag){aj=ag[aa];v=J.input_name(aj);if(v===""){continue}ak=(k=ah.inputs)[v]!=null?k[v]:k[v]={it:0,ic:0};ak["do"]=J["do"]===aa&&!ai?1:0;if(aj.type==="checkbox"||aj.type==="radio"){ak.f=aj.checked?1:0}else{ak.f=aj.value.length?1:0}t.push(v+","+ak.it+","+ak.ic+","+ak.f+","+ak["do"])}if(ai){J.sendTagingsInputs(ag);d.set("_tr_form",(X.encode(J.generate_hash(ah.form)))+","+(ah.it||0)+","+(X.encode(t.join(";")))+","+M.page_id+","+M.session_id);return}return M.collect+="frm,"+(ac())+","+(X.encode(J.generate_hash(ah.form)))+","+(ah.it||0)+","+(X.encode(t.join(";")))+","+M.page_id+";"}},event_handler:function(ah){var k,ao,l,ag,ak,am,ai,t,al,aj,v,an;if(!~"input,select,textarea".indexOf(ah.target.nodeName.toLowerCase())){return}if(~"button,hidden,reset,submit".indexOf(ah.target.type)){return}l=ah.target;al=l;while(al=al.parentNode){if(al.nodeName.toLowerCase()==="form"){break}}if(!al){return}aj=al.getAttribute("data-trid");ai=J.input_name(l);if(!(aj&&ai)){return}ag=(k=J.events)[aj]!=null?k[aj]:k[aj]={it:0,form:al,inputs:{},changed:false};if(ah.orig_type==="change"){J["do"]=""+(Math.max(J["do"],l.getAttribute("data-trid")));ag.changed=true}am=(ao=J.events[aj].inputs)[ai]!=null?ao[ai]:ao[ai]={it:0,ic:0};if(am.is==null){am.is=p()}if(ag.is==null){ag.is=p()}if(ah.orig_type!=="focus"){if(ah.orig_type==="blur"){J.focused_input=null}if(ah.orig_type==="blur"&&l.nodeName.toLowerCase()==="select"){return}if(l.type==="checkbox"||l.type==="radio"){return}an=p()-am.is;if(an<10000){am.it+=an}am.is=p()}else{if(J.focused_input!==l){am.ic++}J.focused_input=l}if(ah.orig_type==="blur"){t=[];v=ag.inputs;for(aa in v){ak=v[aa];t.push(aa+","+(ak.it||0)+","+(ak.ic||0)+","+(ak.f||0))}}if(ah.orig_type==="focus"&&ag.changed){return J.collect(al)}},need_to_mask:function(k){var l=J.input_name(k).toUpperCase();if(a){return true}if(T.indexOf(l)!==-1){return true}if(J.checkInputValueToMask(k)){return true}if(I.closestId(k,"capturlyDontRecordThisText")){return true}if(b.indexOf(l)!==-1){return true}if(I.has_class(k,"capturlyIgnore")){return false}return false},maskInput:function(k){var v=k.cloneNode(true),ag="",t="*";for(var l=0;l<v.value.length;l++){ag+=t}v.value=ag;v.setAttribute("capturlyMasked",null);return v},checkInputValueToMask:function(k){var l=k.value;return l.match(/^[0-9,_-]{10,}$/g)},sendTagingsInputs:function(l){if(typeof l==="object"){var t={};var k=["TEXT","DATE","DATETIME-LOCAL","COLOR","EMAIL","FILE","IMAGE","MONTH","NUMBER","RANGE","SEARCH","TEL","TEXT","TIME","URL","WEEK"];for(aa in l){input=l[aa];input_name=J.input_name(input);if(input_name.toUpperCase()!==""&&D.indexOf(input_name.toUpperCase())!==-1){i=document.getElementsByName(input_name);if(i){ie=i[0];if(ie.tagName==="TEXTAREA"){t[input_name]=ie.value}else{if(ie.tagName==="INPUT"){if(k.indexOf(ie.type.toUpperCase())!==-1){t[input_name]=ie.value}}}}}}if(Object.keys(t).length){E.request(M.url+"/tag","acc="+M.account+"&pid="+M.page_id+"&s="+M.session_id+"&tg="+X.encode(JSON.stringify(t)),function(v){})}}}};y.listener.call(document,"focus",J.event_handler);y.listener.call(document,"blur",J.event_handler);y.listener.call(document,"change",J.event_handler);y.listener.call(document,"keyup",J.event_handler);P=false;u=null;ad=function(){var k=navigator.doNotTrack||navigator.msDoNotTrack;if(k==1){return}if(x()){M.collect="";return}M.page_loaded=true;if(!M.can_send_html){return}if(u&&p()-u<10000){return}if(d.get("__track_optout")){return}u=p();if(n()){if(P||d.get("_tr_stop_collecting")){return}if(M.session_id){H()}if(!M.account){if(M.second_load){return}M.second_load=true;return setTimeout(ad,100)}P=true;return E.getid("acc="+M.account+"&doc="+(encodeURIComponent(window.location.href))+"&ver="+ab+"&sc="+screen.width+"x"+screen.height+"&vp="+M.curr_browser.x+"x"+M.curr_browser.y+"&rt="+M.returning_user+"&rf="+(encodeURIComponent(document.referrer))+"&st="+M.start_time+"&uid="+(d.get("_tr_uid"))+"&cpid="+B,function(l){if((""+l)==="stop"){if(!d.get("_tr_stop_collecting")){d.set("_tr_stop_collecting",1)}}if((""+l).length!==24){return}P=false;M.session_id=l;_paq.push(["setCustomVariable",1,"capturly-session-id",l,"visit"]);_paq.push(["trackPageView"]);if(!d.get("_tr_uid")){d.set("_tr_uid",l,365)}return A()})}else{return setTimeout(function(){return A()},0)}};C=function(){if(M.muo_inited){return}M.muo_inited=true;if(M.muo){return new o}};A=function(){var k;M.last_page_view=p();d.set("_tr_sess",M.session_id+"|"+M.last_page_view);if(!d.get("_tr_sess")){return}window.__tr_sess=M.session_id;if(c()){e=setInterval(function(){return E.ping()},30000);return}C();J.init();if(k=d.get("_tr_form")){d.set("_tr_form","",-1)}return E.send_long("s="+M.session_id+"&pid="+M.page_id+"&acc="+M.account+"&doc="+(encodeURIComponent(window.location.href))+"&ver="+ab+"&tt="+(X.encode(document.title))+"&muo="+(M.muo!=null?"1":"0")+"&h="+(X.encode(I.html()))+"&rf="+(encodeURIComponent(document.referrer))+"&l="+(q.get_data())+"&st="+M.start_time+"&frm="+k+"&cpid="+B,function(){return M.html_sent=true})};if(/p/.test(document.readyState)){ad()}else{y.listener.call(window,"load",ad)}y.listener.call(window,"beforeunload",function(k){E.send_data(true)});y.listener.call(document,"mousemove",function(t){var k,l,v;R();if((t.pageX==null)&&(t.clientX!=null)){v=t.target.ownerDocument||document;l=v.documentElement;k=v.body;t.pageX=t.clientX+(l&&l.scrollLeft||k&&k.scrollLeft||0)-(l&&l.clientLeft||k&&k.clientLeft||0);t.pageY=t.clientY+(l&&l.scrollTop||k&&k.scrollTop||0)-(l&&l.clientTop||k&&k.clientTop||0)}return M.curr_mouse={x:t.pageX,y:t.pageY}});y.listener.call(document,"click",function(ag){var v,k,t,l;R();k=I.offset(ag.target);v="";if(k.w>0&&k.h>0){t=Math.round(100*(M.curr_mouse.x-k.x)/k.w);l=Math.round(100*(M.curr_mouse.y-k.y)/k.h);if(t>=0&&l>=0&&t<=100&&l<=100){v=","+t+"x"+l}}if(!I.path(ag.target)){return}return M.collect+="c,"+(ac())+","+M.curr_mouse.x+","+M.curr_mouse.y+","+(X.encode(I.path(ag.target)))+","+(X.encode(I.path(ag.target,false)))+v+";"});y.listener.call(window,"scroll",function(l){var k;if(k=I.path(l.target)){return M.scroll_elements[k]=l.target}else{return I.scroll_position()}});I.scroll_position();y.listener.call(window,"resize",function(){return I.viewport()});I.viewport();af=function(t){var l;R();l=t.target;if(!l.type||l.type==="password"||I.has_class(l,"no-trackers")){return}if(l.type==="checkbox"||l.type==="radio"){return M.collect+="h,"+(ac())+","+(X.encode(I.path(l)))+","+(l.checked?1:0)+";"}else{if(J.need_to_mask(t.target)){var k=J.maskInput(t.target);var v=k.value}else{var v=l.value}return M.collect+="k,"+(ac())+","+(X.encode(I.path(t.target)))+","+(X.encode(v))+";"}};y.listener.call(document,"change",af);y.listener.call(document,"keyup",af);Y=function(){M.last_non_muo=p();if(M.reset_start_time){M.start_time=ac();return M.reset_start_time=false}};F.push(setInterval(function(){var l,k;if((window.__tr_page_id!=null)&&window.__tr_page_id!==M.page_id){return h()}if(!L(M.curr_mouse,M.last_mouse)){Y();M.last_mouse=M.curr_mouse;M.collect+="m,"+(ac())+","+M.last_mouse.x+","+M.last_mouse.y+";"}if(!L(M.curr_scroll,M.last_scroll)){Y();M.last_scroll=M.curr_scroll;M.collect+="s,"+(ac())+","+M.last_scroll.x+","+M.last_scroll.y+";"}if(!L(M.curr_browser,M.last_browser)){Y();M.last_browser=M.curr_browser;M.collect+="r,"+(ac())+","+M.last_browser.x+","+M.last_browser.y+";"}if(M.scroll_elements){k=M.scroll_elements;for(aa in k){l=k[aa];M.collect+="sce,"+(ac())+","+l.scrollLeft+","+l.scrollTop+","+(X.encode(I.path(l)))+";"}return M.scroll_elements={}}},300));F.push(setInterval(function(){if((window.__tr_page_id!=null)&&window.__tr_page_id!==M.page_id){return}if(p()-M.last_non_muo>125000){return}return E.send_data(false)},3000))}).call(this,cpid);